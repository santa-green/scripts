>>> Расход (Факт) - Приход товара:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) 

SELECT 'Расход (Факт)', t_Rec_1.OurID, r_Ours_22.OurName, t_Rec_1.CodeID1, r_Codes1_42.CodeName1, t_Rec_1.CodeID2, r_Codes1_42.Notes Notes1, r_Codes2_52.CodeName2, r_Codes2_52.Notes Notes2, t_Rec_1.CodeID3, r_Codes3_62.CodeName3, r_Codes3_62.Notes Notes3, t_Rec_1.CodeID4, r_Codes4_72.CodeName4, r_Codes4_72.Notes Notes4, t_Rec_1.CodeID5, r_Codes5_82.CodeName5, r_Codes5_82.Notes Notes5, t_Rec_1.DocDate, t_Rec_1.DepID, r_Deps_241.DepName, SUM(0-(t_RecD_145.Qty * t_PInP_146.CostCC)) SumCC, SUM(0-(t_RecD_145.Qty * t_PInP_146.CostMC)) SumMC, SUM(0-((t_RecD_145.Qty * t_PInP_146.CostCC) / 9)) SumMC_K, SUM(0-(t_RecD_145.Qty * ((t_PInP_146.CostCC / 9) - t_PInP_146.CostMC))) SumCurrDif 
FROM av_t_Rec t_Rec_1 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_22 WITH (NOLOCK) ON (r_Ours_22.OurID = t_Rec_1.OurID)
INNER JOIN r_Codes1 r_Codes1_42 WITH (NOLOCK) ON (r_Codes1_42.CodeID1 = t_Rec_1.CodeID1)
INNER JOIN r_Codes2 r_Codes2_52 WITH (NOLOCK) ON (r_Codes2_52.CodeID2 = t_Rec_1.CodeID2)
INNER JOIN r_Codes3 r_Codes3_62 WITH (NOLOCK) ON (r_Codes3_62.CodeID3 = t_Rec_1.CodeID3)
INNER JOIN r_Codes4 r_Codes4_72 WITH (NOLOCK) ON (r_Codes4_72.CodeID4 = t_Rec_1.CodeID4)
INNER JOIN r_Codes5 r_Codes5_82 WITH (NOLOCK) ON (r_Codes5_82.CodeID5 = t_Rec_1.CodeID5)
INNER JOIN av_t_RecD t_RecD_145 WITH (NOLOCK) ON (t_Rec_1.ChID = t_RecD_145.ChID)
INNER JOIN r_Deps r_Deps_241 WITH (NOLOCK) ON (r_Deps_241.DepID = t_Rec_1.DepID)
INNER JOIN t_PInP t_PInP_146 WITH (NOLOCK) ON (t_PInP_146.PPID = t_RecD_145.PPID) AND (t_PInP_146.ProdID = t_RecD_145.ProdID)  
WHERE  ((t_Rec_1.CodeID1 BETWEEN 2002 AND 2005) OR (t_Rec_1.CodeID1 BETWEEN 2008 AND 2023) OR (t_Rec_1.CodeID1 BETWEEN 2025 AND 2042) OR (t_Rec_1.CodeID1 BETWEEN 2044 AND 2099) OR (t_Rec_1.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Rec_1.CodeID4 BETWEEN 2000 AND 2029) OR (t_Rec_1.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Rec_1.CodeID5 = 2006) OR (t_Rec_1.CodeID5 = 2007) OR (t_Rec_1.CodeID5 = 2008) OR (t_Rec_1.CodeID5 = 2010) OR (t_Rec_1.CodeID5 = 2018) OR (t_Rec_1.CodeID5 = 2022)) AND ((t_Rec_1.OurID BETWEEN 1 AND 5) OR (t_Rec_1.OurID = 11)) AND (t_Rec_1.DocDate BETWEEN '20180601' AND '20180630') AND (t_Rec_1.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_Rec_1.OurID, r_Ours_22.OurName, t_Rec_1.CodeID1, r_Codes1_42.CodeName1, t_Rec_1.CodeID2, r_Codes1_42.Notes, r_Codes2_52.CodeName2, r_Codes2_52.Notes, t_Rec_1.CodeID3, r_Codes3_62.CodeName3, r_Codes3_62.Notes, t_Rec_1.CodeID4, r_Codes4_72.CodeName4, r_Codes4_72.Notes, t_Rec_1.CodeID5, r_Codes5_82.CodeName5, r_Codes5_82.Notes, t_Rec_1.DocDate, t_Rec_1.DepID, r_Deps_241.DepName


>>> Расход (Факт) - Возврат товара от получателя:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Ret_2.OurID, r_Ours_23.OurName, t_Ret_2.CodeID1, r_Codes1_43.CodeName1, t_Ret_2.CodeID2, r_Codes1_43.Notes Notes1, r_Codes2_53.CodeName2, r_Codes2_53.Notes Notes2, t_Ret_2.CodeID3, r_Codes3_63.CodeName3, r_Codes3_63.Notes Notes3, t_Ret_2.CodeID4, r_Codes4_73.CodeName4, r_Codes4_73.Notes Notes4, t_Ret_2.CodeID5, r_Codes5_83.CodeName5, r_Codes5_83.Notes Notes5, t_Ret_2.DocDate, t_Ret_2.DepID, r_Deps_246.DepName, SUM(0-(t_RetD_141.Qty * t_PInP_142.CostCC)) SumCC, SUM(0-(t_RetD_141.Qty * t_PInP_142.CostMC)) SumMC, SUM(0-((t_RetD_141.Qty * t_PInP_142.CostCC) / 9)) SumMC_K, SUM(0-(t_RetD_141.Qty * ((t_PInP_142.CostCC / 9) - (t_PInP_142.CostMC)))) SumCurrDif FROM av_t_Ret t_Ret_2 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_23 WITH (NOLOCK) ON (r_Ours_23.OurID = t_Ret_2.OurID)
INNER JOIN r_Codes1 r_Codes1_43 WITH (NOLOCK) ON (r_Codes1_43.CodeID1 = t_Ret_2.CodeID1)
INNER JOIN r_Codes2 r_Codes2_53 WITH (NOLOCK) ON (r_Codes2_53.CodeID2 = t_Ret_2.CodeID2)
INNER JOIN r_Codes3 r_Codes3_63 WITH (NOLOCK) ON (r_Codes3_63.CodeID3 = t_Ret_2.CodeID3)
INNER JOIN r_Codes4 r_Codes4_73 WITH (NOLOCK) ON (r_Codes4_73.CodeID4 = t_Ret_2.CodeID4)
INNER JOIN r_Codes5 r_Codes5_83 WITH (NOLOCK) ON (r_Codes5_83.CodeID5 = t_Ret_2.CodeID5)
INNER JOIN av_t_RetD t_RetD_141 WITH (NOLOCK) ON (t_Ret_2.ChID = t_RetD_141.ChID)
INNER JOIN r_Deps r_Deps_246 WITH (NOLOCK) ON (r_Deps_246.DepID = t_Ret_2.DepID)
INNER JOIN t_PInP t_PInP_142 WITH (NOLOCK) ON (t_PInP_142.PPID = t_RetD_141.PPID) AND (t_PInP_142.ProdID = t_RetD_141.ProdID)  WHERE  ((t_Ret_2.CodeID1 BETWEEN 2002 AND 2005) OR (t_Ret_2.CodeID1 BETWEEN 2008 AND 2023) OR (t_Ret_2.CodeID1 BETWEEN 2025 AND 2042) OR (t_Ret_2.CodeID1 BETWEEN 2044 AND 2099) OR (t_Ret_2.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Ret_2.CodeID4 BETWEEN 2000 AND 2029) OR (t_Ret_2.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Ret_2.CodeID5 = 2006) OR (t_Ret_2.CodeID5 = 2007) OR (t_Ret_2.CodeID5 = 2008) OR (t_Ret_2.CodeID5 = 2010) OR (t_Ret_2.CodeID5 = 2018) OR (t_Ret_2.CodeID5 = 2022)) AND ((t_Ret_2.OurID BETWEEN 1 AND 5) OR (t_Ret_2.OurID = 11)) AND (t_Ret_2.DocDate BETWEEN '20180601' AND '20180630') AND (t_Ret_2.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_Ret_2.OurID, r_Ours_23.OurName, t_Ret_2.CodeID1, r_Codes1_43.CodeName1, t_Ret_2.CodeID2, r_Codes1_43.Notes, r_Codes2_53.CodeName2, r_Codes2_53.Notes, t_Ret_2.CodeID3, r_Codes3_63.CodeName3, r_Codes3_63.Notes, t_Ret_2.CodeID4, r_Codes4_73.CodeName4, r_Codes4_73.Notes, t_Ret_2.CodeID5, r_Codes5_83.CodeName5, r_Codes5_83.Notes, t_Ret_2.DocDate, t_Ret_2.DepID, r_Deps_246.DepName


>>> Расход (Факт) - Возврат товара поставщику:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_CRet_3.OurID, r_Ours_24.OurName, t_CRet_3.CodeID1, r_Codes1_44.CodeName1, t_CRet_3.CodeID2, r_Codes1_44.Notes Notes1, r_Codes2_54.CodeName2, r_Codes2_54.Notes Notes2, t_CRet_3.CodeID3, r_Codes3_64.CodeName3, r_Codes3_64.Notes Notes3, t_CRet_3.CodeID4, r_Codes4_74.CodeName4, r_Codes4_74.Notes Notes4, t_CRet_3.CodeID5, r_Codes5_84.CodeName5, r_Codes5_84.Notes Notes5, t_CRet_3.DocDate, 0, '', SUM(t_CRetD_143.Qty * t_PInP_144.CostCC) SumCC, SUM(t_CRetD_143.Qty * t_PInP_144.CostMC) SumMC, SUM((t_CRetD_143.Qty * t_PInP_144.CostCC) / 9) SumMC_K, SUM(t_CRetD_143.Qty * ((t_PInP_144.CostCC / 9) - t_PInP_144.CostMC)) SumCurrDif FROM av_t_CRet t_CRet_3 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_24 WITH (NOLOCK) ON (r_Ours_24.OurID = t_CRet_3.OurID)
INNER JOIN r_Codes1 r_Codes1_44 WITH (NOLOCK) ON (r_Codes1_44.CodeID1 = t_CRet_3.CodeID1)
INNER JOIN r_Codes2 r_Codes2_54 WITH (NOLOCK) ON (r_Codes2_54.CodeID2 = t_CRet_3.CodeID2)
INNER JOIN r_Codes3 r_Codes3_64 WITH (NOLOCK) ON (r_Codes3_64.CodeID3 = t_CRet_3.CodeID3)
INNER JOIN r_Codes4 r_Codes4_74 WITH (NOLOCK) ON (r_Codes4_74.CodeID4 = t_CRet_3.CodeID4)
INNER JOIN r_Codes5 r_Codes5_84 WITH (NOLOCK) ON (r_Codes5_84.CodeID5 = t_CRet_3.CodeID5)
INNER JOIN av_t_CRetD t_CRetD_143 WITH (NOLOCK) ON (t_CRet_3.ChID = t_CRetD_143.ChID)
INNER JOIN t_PInP t_PInP_144 WITH (NOLOCK) ON (t_PInP_144.PPID = t_CRetD_143.PPID) AND (t_PInP_144.ProdID = t_CRetD_143.ProdID)  WHERE  ((t_CRet_3.CodeID1 BETWEEN 2002 AND 2005) OR (t_CRet_3.CodeID1 BETWEEN 2008 AND 2023) OR (t_CRet_3.CodeID1 BETWEEN 2025 AND 2042) OR (t_CRet_3.CodeID1 BETWEEN 2044 AND 2099) OR (t_CRet_3.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_CRet_3.CodeID4 BETWEEN 2000 AND 2029) OR (t_CRet_3.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_CRet_3.CodeID5 = 2006) OR (t_CRet_3.CodeID5 = 2007) OR (t_CRet_3.CodeID5 = 2008) OR (t_CRet_3.CodeID5 = 2010) OR (t_CRet_3.CodeID5 = 2018) OR (t_CRet_3.CodeID5 = 2022)) AND ((t_CRet_3.OurID BETWEEN 1 AND 5) OR (t_CRet_3.OurID = 11)) AND (t_CRet_3.DocDate BETWEEN '20180601' AND '20180630') AND (t_CRet_3.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_CRet_3.OurID, r_Ours_24.OurName, t_CRet_3.CodeID1, r_Codes1_44.CodeName1, t_CRet_3.CodeID2, r_Codes1_44.Notes, r_Codes2_54.CodeName2, r_Codes2_54.Notes, t_CRet_3.CodeID3, r_Codes3_64.CodeName3, r_Codes3_64.Notes, t_CRet_3.CodeID4, r_Codes4_74.CodeName4, r_Codes4_74.Notes, t_CRet_3.CodeID5, r_Codes5_84.CodeName5, r_Codes5_84.Notes, t_CRet_3.DocDate


>>> Расход (Факт) - Расходная накладная:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Inv_4.OurID, r_Ours_25.OurName, t_Inv_4.CodeID1, r_Codes1_45.CodeName1, t_Inv_4.CodeID2, r_Codes1_45.Notes Notes1, r_Codes2_55.CodeName2, r_Codes2_55.Notes Notes2, t_Inv_4.CodeID3, r_Codes3_65.CodeName3, r_Codes3_65.Notes Notes3, t_Inv_4.CodeID4, r_Codes4_75.CodeName4, r_Codes4_75.Notes Notes4, t_Inv_4.CodeID5, r_Codes5_85.CodeName5, r_Codes5_85.Notes Notes5, t_Inv_4.DocDate, t_Inv_4.DepID, r_Deps_274.DepName, SUM(t_InvD_147.Qty * t_PInP_148.CostCC) SumCC, SUM(t_InvD_147.Qty * t_PInP_148.CostMC) SumMC, SUM((t_InvD_147.Qty * t_PInP_148.CostCC) / 9) SumMC_K, SUM(t_InvD_147.Qty * ((t_PInP_148.CostCC / 9) - t_PInP_148.CostMC)) SumCurrDif FROM av_t_Inv t_Inv_4 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_25 WITH (NOLOCK) ON (r_Ours_25.OurID = t_Inv_4.OurID)
INNER JOIN r_Codes1 r_Codes1_45 WITH (NOLOCK) ON (r_Codes1_45.CodeID1 = t_Inv_4.CodeID1)
INNER JOIN r_Codes2 r_Codes2_55 WITH (NOLOCK) ON (r_Codes2_55.CodeID2 = t_Inv_4.CodeID2)
INNER JOIN r_Codes3 r_Codes3_65 WITH (NOLOCK) ON (r_Codes3_65.CodeID3 = t_Inv_4.CodeID3)
INNER JOIN r_Codes4 r_Codes4_75 WITH (NOLOCK) ON (r_Codes4_75.CodeID4 = t_Inv_4.CodeID4)
INNER JOIN r_Codes5 r_Codes5_85 WITH (NOLOCK) ON (r_Codes5_85.CodeID5 = t_Inv_4.CodeID5)
INNER JOIN av_t_InvD t_InvD_147 WITH (NOLOCK) ON (t_Inv_4.ChID = t_InvD_147.ChID)
INNER JOIN r_Deps r_Deps_274 WITH (NOLOCK) ON (r_Deps_274.DepID = t_Inv_4.DepID)
INNER JOIN t_PInP t_PInP_148 WITH (NOLOCK) ON (t_PInP_148.PPID = t_InvD_147.PPID) AND (t_PInP_148.ProdID = t_InvD_147.ProdID)  WHERE  ((t_Inv_4.CodeID1 BETWEEN 2002 AND 2005) OR (t_Inv_4.CodeID1 BETWEEN 2008 AND 2023) OR (t_Inv_4.CodeID1 BETWEEN 2025 AND 2042) OR (t_Inv_4.CodeID1 BETWEEN 2044 AND 2099) OR (t_Inv_4.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Inv_4.CodeID4 BETWEEN 2000 AND 2029) OR (t_Inv_4.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Inv_4.CodeID5 = 2006) OR (t_Inv_4.CodeID5 = 2007) OR (t_Inv_4.CodeID5 = 2008) OR (t_Inv_4.CodeID5 = 2010) OR (t_Inv_4.CodeID5 = 2018) OR (t_Inv_4.CodeID5 = 2022)) AND ((t_Inv_4.OurID BETWEEN 1 AND 5) OR (t_Inv_4.OurID = 11)) AND (t_Inv_4.DocDate BETWEEN '20180601' AND '20180630') AND (t_Inv_4.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_Inv_4.OurID, r_Ours_25.OurName, t_Inv_4.CodeID1, r_Codes1_45.CodeName1, t_Inv_4.CodeID2, r_Codes1_45.Notes, r_Codes2_55.CodeName2, r_Codes2_55.Notes, t_Inv_4.CodeID3, r_Codes3_65.CodeName3, r_Codes3_65.Notes, t_Inv_4.CodeID4, r_Codes4_75.CodeName4, r_Codes4_75.Notes, t_Inv_4.CodeID5, r_Codes5_85.CodeName5, r_Codes5_85.Notes, t_Inv_4.DocDate, t_Inv_4.DepID, r_Deps_274.DepName

--1
>>> Расход (Факт) - Расходный документ:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Exp_5.OurID, r_Ours_26.OurName, t_Exp_5.CodeID1, r_Codes1_46.CodeName1, t_Exp_5.CodeID2, r_Codes1_46.Notes Notes1, r_Codes2_56.CodeName2, r_Codes2_56.Notes Notes2, t_Exp_5.CodeID3, r_Codes3_66.CodeName3, r_Codes3_66.Notes Notes3, t_Exp_5.CodeID4, r_Codes4_76.CodeName4, r_Codes4_76.Notes Notes4, t_Exp_5.CodeID5, r_Codes5_86.CodeName5, r_Codes5_86.Notes Notes5, t_Exp_5.DocDate, t_Exp_5.DepID, r_Deps_299.DepName, SUM(t_ExpD_149.Qty * t_PInP_150.CostCC) SumCC, SUM(t_ExpD_149.Qty * t_PInP_150.CostMC) SumMC, SUM((t_ExpD_149.Qty * t_PInP_150.CostCC) / 9) SumMC_K, SUM(t_ExpD_149.Qty * ((t_PInP_150.CostCC / 9) - t_PInP_150.CostMC)) SumCurrDif FROM av_t_Exp t_Exp_5 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_26 WITH (NOLOCK) ON (r_Ours_26.OurID = t_Exp_5.OurID)
INNER JOIN r_Codes1 r_Codes1_46 WITH (NOLOCK) ON (r_Codes1_46.CodeID1 = t_Exp_5.CodeID1)
INNER JOIN r_Codes2 r_Codes2_56 WITH (NOLOCK) ON (r_Codes2_56.CodeID2 = t_Exp_5.CodeID2)
INNER JOIN r_Codes3 r_Codes3_66 WITH (NOLOCK) ON (r_Codes3_66.CodeID3 = t_Exp_5.CodeID3)
INNER JOIN r_Codes4 r_Codes4_76 WITH (NOLOCK) ON (r_Codes4_76.CodeID4 = t_Exp_5.CodeID4)
INNER JOIN r_Codes5 r_Codes5_86 WITH (NOLOCK) ON (r_Codes5_86.CodeID5 = t_Exp_5.CodeID5)
INNER JOIN av_t_ExpD t_ExpD_149 WITH (NOLOCK) ON (t_Exp_5.ChID = t_ExpD_149.ChID)
INNER JOIN r_Deps r_Deps_299 WITH (NOLOCK) ON (r_Deps_299.DepID = t_Exp_5.DepID)
INNER JOIN t_PInP t_PInP_150 WITH (NOLOCK) ON (t_PInP_150.PPID = t_ExpD_149.PPID) AND (t_PInP_150.ProdID = t_ExpD_149.ProdID)  WHERE  ((t_Exp_5.CodeID1 BETWEEN 2002 AND 2005) OR (t_Exp_5.CodeID1 BETWEEN 2008 AND 2023) OR (t_Exp_5.CodeID1 BETWEEN 2025 AND 2042) OR (t_Exp_5.CodeID1 BETWEEN 2044 AND 2099) OR (t_Exp_5.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Exp_5.CodeID4 BETWEEN 2000 AND 2029) OR (t_Exp_5.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Exp_5.CodeID5 = 2006) OR (t_Exp_5.CodeID5 = 2007) OR (t_Exp_5.CodeID5 = 2008) OR (t_Exp_5.CodeID5 = 2010) OR (t_Exp_5.CodeID5 = 2018) OR (t_Exp_5.CodeID5 = 2022)) AND ((t_Exp_5.OurID BETWEEN 1 AND 5) OR (t_Exp_5.OurID = 11)) AND (t_Exp_5.DocDate BETWEEN '20180601' AND '20180630') AND (t_Exp_5.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_Exp_5.OurID, r_Ours_26.OurName, t_Exp_5.CodeID1, r_Codes1_46.CodeName1, t_Exp_5.CodeID2, r_Codes1_46.Notes, r_Codes2_56.CodeName2, r_Codes2_56.Notes, t_Exp_5.CodeID3, r_Codes3_66.CodeName3, r_Codes3_66.Notes, t_Exp_5.CodeID4, r_Codes4_76.CodeName4, r_Codes4_76.Notes, t_Exp_5.CodeID5, r_Codes5_86.CodeName5, r_Codes5_86.Notes, t_Exp_5.DocDate, t_Exp_5.DepID, r_Deps_299.DepName

--2
>>> Расход (Факт) - Расходный документ в ценах прихода:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Epp_6.OurID, r_Ours_27.OurName, t_Epp_6.CodeID1, r_Codes1_47.CodeName1, t_Epp_6.CodeID2, r_Codes1_47.Notes Notes1, r_Codes2_57.CodeName2, r_Codes2_57.Notes Notes2, t_Epp_6.CodeID3, r_Codes3_67.CodeName3, r_Codes3_67.Notes Notes3, t_Epp_6.CodeID4, r_Codes4_77.CodeName4, r_Codes4_77.Notes Notes4, t_Epp_6.CodeID5, r_Codes5_87.CodeName5, r_Codes5_87.Notes Notes5, t_Epp_6.DocDate, t_Epp_6.DepID, r_Deps_302.DepName, SUM(t_EppD_151.Qty * t_PInP_152.CostCC) SumCC, SUM(t_EppD_151.Qty * t_PInP_152.CostMC) SumMC, SUM((t_EppD_151.Qty * t_PInP_152.CostCC) / 9) SumMC_K, SUM(t_EppD_151.Qty * ((t_PInP_152.CostCC / 9) - t_PInP_152.CostMC)) SumCurrDif FROM av_t_Epp t_Epp_6 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_27 WITH (NOLOCK) ON (r_Ours_27.OurID = t_Epp_6.OurID)
INNER JOIN r_Codes1 r_Codes1_47 WITH (NOLOCK) ON (r_Codes1_47.CodeID1 = t_Epp_6.CodeID1)
INNER JOIN r_Codes2 r_Codes2_57 WITH (NOLOCK) ON (r_Codes2_57.CodeID2 = t_Epp_6.CodeID2)
INNER JOIN r_Codes3 r_Codes3_67 WITH (NOLOCK) ON (r_Codes3_67.CodeID3 = t_Epp_6.CodeID3)
INNER JOIN r_Codes4 r_Codes4_77 WITH (NOLOCK) ON (r_Codes4_77.CodeID4 = t_Epp_6.CodeID4)
INNER JOIN r_Codes5 r_Codes5_87 WITH (NOLOCK) ON (r_Codes5_87.CodeID5 = t_Epp_6.CodeID5)
INNER JOIN av_t_EppD t_EppD_151 WITH (NOLOCK) ON (t_Epp_6.ChID = t_EppD_151.ChID)
INNER JOIN r_Deps r_Deps_302 WITH (NOLOCK) ON (r_Deps_302.DepID = t_Epp_6.DepID)
INNER JOIN t_PInP t_PInP_152 WITH (NOLOCK) ON (t_PInP_152.PPID = t_EppD_151.PPID) AND (t_PInP_152.ProdID = t_EppD_151.ProdID)  WHERE  ((t_Epp_6.CodeID1 BETWEEN 2002 AND 2005) OR (t_Epp_6.CodeID1 BETWEEN 2008 AND 2023) OR (t_Epp_6.CodeID1 BETWEEN 2025 AND 2042) OR (t_Epp_6.CodeID1 BETWEEN 2044 AND 2099) OR (t_Epp_6.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Epp_6.CodeID4 BETWEEN 2000 AND 2029) OR (t_Epp_6.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Epp_6.CodeID5 = 2006) OR (t_Epp_6.CodeID5 = 2007) OR (t_Epp_6.CodeID5 = 2008) OR (t_Epp_6.CodeID5 = 2010) OR (t_Epp_6.CodeID5 = 2018) OR (t_Epp_6.CodeID5 = 2022)) AND ((t_Epp_6.OurID BETWEEN 1 AND 5) OR (t_Epp_6.OurID = 11)) AND (t_Epp_6.DocDate BETWEEN '20180601' AND '20180630') AND (t_Epp_6.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_Epp_6.OurID, r_Ours_27.OurName, t_Epp_6.CodeID1, r_Codes1_47.CodeName1, t_Epp_6.CodeID2, r_Codes1_47.Notes, r_Codes2_57.CodeName2, r_Codes2_57.Notes, t_Epp_6.CodeID3, r_Codes3_67.CodeName3, r_Codes3_67.Notes, t_Epp_6.CodeID4, r_Codes4_77.CodeName4, r_Codes4_77.Notes, t_Epp_6.CodeID5, r_Codes5_87.CodeName5, r_Codes5_87.Notes, t_Epp_6.DocDate, t_Epp_6.DepID, r_Deps_302.DepName

--3
>>> Расход (Факт) - Переоценка цен прихода (Приход):
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Est_7.OurID, r_Ours_29.OurName, r_Codes1_183.CodeID1, r_Codes1_183.CodeName1, r_Codes2_184.CodeID2, r_Codes1_183.Notes Notes1, r_Codes2_184.CodeName2, r_Codes2_184.Notes Notes2, t_Est_7.CodeID3, r_Codes3_69.CodeName3, r_Codes3_69.Notes Notes3, r_Codes4_193.CodeID4, r_Codes4_193.CodeName4, r_Codes4_193.Notes Notes4, r_Codes5_185.CodeID5, r_Codes5_185.CodeName5, r_Codes5_185.Notes Notes5, t_Est_7.DocDate, r_Deps_213.DepID, r_Deps_213.DepName, SUM(0-(t_EstD_153.Qty * t_PInP_154.CostCC)) SumCC, SUM(0-(t_EstD_153.Qty * t_PInP_154.CostMC)) SumMC, SUM(0-((t_EstD_153.Qty * t_PInP_154.CostCC) / 9)) SumMC_K, SUM(0-(t_EstD_153.Qty * ((t_PInP_154.CostCC / 9) - t_PInP_154.CostMC))) SumCurrDif FROM av_t_Est t_Est_7 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_29 WITH (NOLOCK) ON (r_Ours_29.OurID = t_Est_7.OurID)
INNER JOIN r_Codes3 r_Codes3_69 WITH (NOLOCK) ON (r_Codes3_69.CodeID3 = t_Est_7.CodeID3)
INNER JOIN av_t_EstD t_EstD_153 WITH (NOLOCK) ON (t_Est_7.ChID = t_EstD_153.ChID)
INNER JOIN r_Stocks r_Stocks_189 WITH (NOLOCK) ON (r_Stocks_189.StockID = t_Est_7.StockID)
INNER JOIN t_PInP t_PInP_154 WITH (NOLOCK) ON (t_PInP_154.PPID = t_EstD_153.NewPPID) AND (t_PInP_154.ProdID = t_EstD_153.ProdID)
INNER JOIN r_Prods r_Prods_168 WITH (NOLOCK) ON (r_Prods_168.ProdID = t_PInP_154.ProdID)
INNER JOIN r_ProdC r_ProdC_180 WITH (NOLOCK) ON (r_ProdC_180.PCatID = r_Prods_168.PCatID)
INNER JOIN r_ProdG r_ProdG_181 WITH (NOLOCK) ON (r_ProdG_181.PGrID = r_Prods_168.PGrID)
INNER JOIN r_ProdG1 r_ProdG1_182 WITH (NOLOCK) ON (r_ProdG1_182.PGrID1 = r_Prods_168.PGrID1)
INNER JOIN r_Codes1 r_Codes1_183 WITH (NOLOCK) ON (r_Codes1_183.CodeID1 = r_ProdC_180.CodeID1)
INNER JOIN r_Codes2 r_Codes2_184 WITH (NOLOCK) ON (r_Codes2_184.CodeID2 = r_ProdG_181.CodeID2)
INNER JOIN r_Codes5 r_Codes5_185 WITH (NOLOCK) ON (r_Codes5_185.CodeID5 = r_ProdG1_182.CodeID5)
INNER JOIN r_StockGs r_StockGs_190 WITH (NOLOCK) ON (r_StockGs_190.StockGID = r_Stocks_189.StockGID)
INNER JOIN r_Deps r_Deps_213 WITH (NOLOCK) ON (r_Deps_213.DepID = r_Stocks_189.DepID)
INNER JOIN r_Codes4 r_Codes4_193 WITH (NOLOCK) ON (r_Codes4_193.CodeID4 = r_StockGs_190.StockGID)  WHERE  ((r_Codes1_183.CodeID1 BETWEEN 2002 AND 2005) OR (r_Codes1_183.CodeID1 BETWEEN 2008 AND 2023) OR (r_Codes1_183.CodeID1 BETWEEN 2025 AND 2042) OR (r_Codes1_183.CodeID1 BETWEEN 2044 AND 2099) OR (r_Codes1_183.CodeID1 BETWEEN 2101 AND 3001)) AND ((r_Codes4_193.CodeID4 BETWEEN 2000 AND 2029) OR (r_Codes4_193.CodeID4 BETWEEN 2100 AND 3000)) AND ((r_Codes5_185.CodeID5 = 2006) OR (r_Codes5_185.CodeID5 = 2007) OR (r_Codes5_185.CodeID5 = 2008) OR (r_Codes5_185.CodeID5 = 2010) OR (r_Codes5_185.CodeID5 = 2018) OR (r_Codes5_185.CodeID5 = 2022)) AND ((t_Est_7.OurID BETWEEN 1 AND 5) OR (t_Est_7.OurID = 11)) AND (t_Est_7.DocDate BETWEEN '20180601' AND '20180630') AND ((t_Est_7.OurID IN (1,11,2,3,5,6,4) AND (r_Prods_168.PCatID BETWEEN 600 AND 699) AND ((r_Prods_168.PGrID BETWEEN 9100 AND 9999) OR (r_Prods_168.PGrID BETWEEN 16000 AND 17000)))) GROUP BY t_Est_7.OurID, r_Ours_29.OurName, r_Codes1_183.CodeID1, r_Codes1_183.CodeName1, r_Codes2_184.CodeID2, r_Codes1_183.Notes, r_Codes2_184.CodeName2, r_Codes2_184.Notes, t_Est_7.CodeID3, r_Codes3_69.CodeName3, r_Codes3_69.Notes, r_Codes4_193.CodeID4, r_Codes4_193.CodeName4, r_Codes4_193.Notes, r_Codes5_185.CodeID5, r_Codes5_185.CodeName5, r_Codes5_185.Notes, t_Est_7.DocDate, r_Deps_213.DepID, r_Deps_213.DepName


>>> Расход (Факт) - Приход денег по предприятиям:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', c_CompRec_9.OurID, r_Ours_30.OurName, c_CompRec_9.CodeID1, r_Codes1_50.CodeName1, c_CompRec_9.CodeID2, r_Codes1_50.Notes Notes1, r_Codes2_60.CodeName2, r_Codes2_60.Notes Notes2, c_CompRec_9.CodeID3, r_Codes3_70.CodeName3, r_Codes3_70.Notes Notes3, c_CompRec_9.CodeID4, r_Codes4_80.CodeName4, r_Codes4_80.Notes Notes4, c_CompRec_9.CodeID5, r_Codes5_90.CodeName5, r_Codes5_90.Notes Notes5, c_CompRec_9.DocDate, c_CompRec_9.DepID, r_Deps_323.DepName, SUM(0-(c_CompRec_9.SumAC * c_CompRec_9.KursCC)) SumCC, SUM(0-(c_CompRec_9.SumAC / c_CompRec_9.KursMC)) SumMC, SUM(0-((c_CompRec_9.SumAC * c_CompRec_9.KursCC) / 9)) SumMC_K, SUM(0-(((c_CompRec_9.SumAC * c_CompRec_9.KursCC) / c_CompRec_9.KursMC) - (c_CompRec_9.SumAC / c_CompRec_9.KursMC))) SumCurrDif FROM av_c_CompRec c_CompRec_9 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_30 WITH (NOLOCK) ON (r_Ours_30.OurID = c_CompRec_9.OurID)
INNER JOIN r_Codes1 r_Codes1_50 WITH (NOLOCK) ON (r_Codes1_50.CodeID1 = c_CompRec_9.CodeID1)
INNER JOIN r_Codes2 r_Codes2_60 WITH (NOLOCK) ON (r_Codes2_60.CodeID2 = c_CompRec_9.CodeID2)
INNER JOIN r_Codes3 r_Codes3_70 WITH (NOLOCK) ON (r_Codes3_70.CodeID3 = c_CompRec_9.CodeID3)
INNER JOIN r_Codes4 r_Codes4_80 WITH (NOLOCK) ON (r_Codes4_80.CodeID4 = c_CompRec_9.CodeID4)
INNER JOIN r_Codes5 r_Codes5_90 WITH (NOLOCK) ON (r_Codes5_90.CodeID5 = c_CompRec_9.CodeID5)
INNER JOIN r_Deps r_Deps_323 WITH (NOLOCK) ON (r_Deps_323.DepID = c_CompRec_9.DepID)  WHERE  ((c_CompRec_9.CodeID1 BETWEEN 2002 AND 2005) OR (c_CompRec_9.CodeID1 BETWEEN 2008 AND 2023) OR (c_CompRec_9.CodeID1 BETWEEN 2025 AND 2042) OR (c_CompRec_9.CodeID1 BETWEEN 2044 AND 2099) OR (c_CompRec_9.CodeID1 BETWEEN 2101 AND 3001)) AND ((c_CompRec_9.CodeID4 BETWEEN 2000 AND 2029) OR (c_CompRec_9.CodeID4 BETWEEN 2100 AND 3000)) AND ((c_CompRec_9.CodeID5 = 2006) OR (c_CompRec_9.CodeID5 = 2007) OR (c_CompRec_9.CodeID5 = 2008) OR (c_CompRec_9.CodeID5 = 2010) OR (c_CompRec_9.CodeID5 = 2018) OR (c_CompRec_9.CodeID5 = 2022)) AND ((c_CompRec_9.OurID BETWEEN 1 AND 5) OR (c_CompRec_9.OurID = 11)) AND (c_CompRec_9.DocDate BETWEEN '20180601' AND '20180630') AND (c_CompRec_9.OurID IN (1,11,2,3,5,6,4)) GROUP BY c_CompRec_9.OurID, r_Ours_30.OurName, c_CompRec_9.CodeID1, r_Codes1_50.CodeName1, c_CompRec_9.CodeID2, r_Codes1_50.Notes, r_Codes2_60.CodeName2, r_Codes2_60.Notes, c_CompRec_9.CodeID3, r_Codes3_70.CodeName3, r_Codes3_70.Notes, c_CompRec_9.CodeID4, r_Codes4_80.CodeName4, r_Codes4_80.Notes, c_CompRec_9.CodeID5, r_Codes5_90.CodeName5, r_Codes5_90.Notes, c_CompRec_9.DocDate, c_CompRec_9.DepID, r_Deps_323.DepName

--4
>>> Расход (Факт) - Расход денег по предприятиям:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', c_CompExp_10.OurID, r_Ours_31.OurName, c_CompExp_10.CodeID1, r_Codes1_51.CodeName1, c_CompExp_10.CodeID2, r_Codes1_51.Notes Notes1, r_Codes2_61.CodeName2, r_Codes2_61.Notes Notes2, c_CompExp_10.CodeID3, r_Codes3_71.CodeName3, r_Codes3_71.Notes Notes3, c_CompExp_10.CodeID4, r_Codes4_81.CodeName4, r_Codes4_81.Notes Notes4, c_CompExp_10.CodeID5, r_Codes5_91.CodeName5, r_Codes5_91.Notes Notes5, c_CompExp_10.DocDate, c_CompExp_10.DepID, r_Deps_324.DepName, SUM(c_CompExp_10.SumAC * c_CompExp_10.KursCC) SumCC, SUM(c_CompExp_10.SumAC / c_CompExp_10.KursMC) SumMC, SUM((c_CompExp_10.SumAC * c_CompExp_10.KursCC) / 9) SumMC_K, SUM(((c_CompExp_10.SumAC * c_CompExp_10.KursCC) / 9) - (c_CompExp_10.SumAC / c_CompExp_10.KursMC)) SumCurrDif FROM av_c_CompExp c_CompExp_10 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_31 WITH (NOLOCK) ON (r_Ours_31.OurID = c_CompExp_10.OurID)
INNER JOIN r_Codes1 r_Codes1_51 WITH (NOLOCK) ON (r_Codes1_51.CodeID1 = c_CompExp_10.CodeID1)
INNER JOIN r_Codes2 r_Codes2_61 WITH (NOLOCK) ON (r_Codes2_61.CodeID2 = c_CompExp_10.CodeID2)
INNER JOIN r_Codes3 r_Codes3_71 WITH (NOLOCK) ON (r_Codes3_71.CodeID3 = c_CompExp_10.CodeID3)
INNER JOIN r_Codes4 r_Codes4_81 WITH (NOLOCK) ON (r_Codes4_81.CodeID4 = c_CompExp_10.CodeID4)
INNER JOIN r_Codes5 r_Codes5_91 WITH (NOLOCK) ON (r_Codes5_91.CodeID5 = c_CompExp_10.CodeID5)
INNER JOIN r_Deps r_Deps_324 WITH (NOLOCK) ON (r_Deps_324.DepID = c_CompExp_10.DepID)  WHERE  ((c_CompExp_10.CodeID1 BETWEEN 2002 AND 2005) OR (c_CompExp_10.CodeID1 BETWEEN 2008 AND 2023) OR (c_CompExp_10.CodeID1 BETWEEN 2025 AND 2042) OR (c_CompExp_10.CodeID1 BETWEEN 2044 AND 2099) OR (c_CompExp_10.CodeID1 BETWEEN 2101 AND 3001)) AND ((c_CompExp_10.CodeID4 BETWEEN 2000 AND 2029) OR (c_CompExp_10.CodeID4 BETWEEN 2100 AND 3000)) AND ((c_CompExp_10.CodeID5 = 2006) OR (c_CompExp_10.CodeID5 = 2007) OR (c_CompExp_10.CodeID5 = 2008) OR (c_CompExp_10.CodeID5 = 2010) OR (c_CompExp_10.CodeID5 = 2018) OR (c_CompExp_10.CodeID5 = 2022)) AND ((c_CompExp_10.OurID BETWEEN 1 AND 5) OR (c_CompExp_10.OurID = 11)) AND (c_CompExp_10.DocDate BETWEEN '20180601' AND '20180630') AND (c_CompExp_10.OurID IN (1,11,2,3,5,6,4)) GROUP BY c_CompExp_10.OurID, r_Ours_31.OurName, c_CompExp_10.CodeID1, r_Codes1_51.CodeName1, c_CompExp_10.CodeID2, r_Codes1_51.Notes, r_Codes2_61.CodeName2, r_Codes2_61.Notes, c_CompExp_10.CodeID3, r_Codes3_71.CodeName3, r_Codes3_71.Notes, c_CompExp_10.CodeID4, r_Codes4_81.CodeName4, r_Codes4_81.Notes, c_CompExp_10.CodeID5, r_Codes5_91.CodeName5, r_Codes5_91.Notes, c_CompExp_10.DocDate, c_CompExp_10.DepID, r_Deps_324.DepName


>>> Расход (Факт) - Прием наличных денег на склад:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_MonRec_11.OurID, r_Ours_28.OurName, t_MonRec_11.CodeID1, r_Codes1_48.CodeName1, t_MonRec_11.CodeID2, r_Codes1_48.Notes Notes1, r_Codes2_58.CodeName2, r_Codes2_58.Notes Notes2, t_MonRec_11.CodeID3, r_Codes3_68.CodeName3, r_Codes3_68.Notes Notes3, t_MonRec_11.CodeID4, r_Codes4_78.CodeName4, r_Codes4_78.Notes Notes4, t_MonRec_11.CodeID5, r_Codes5_88.CodeName5, r_Codes5_88.Notes Notes5, t_MonRec_11.DocDate, 0, '', SUM(0-(t_MonRec_11.SumAC * t_MonRec_11.KursCC)) SumCC, SUM(0-(t_MonRec_11.SumAC / t_MonRec_11.KursMC)) SumMC, SUM(0-((t_MonRec_11.SumAC * t_MonRec_11.KursCC) / 9)) SumMC_K, SUM(0-(((t_MonRec_11.SumAC * t_MonRec_11.KursCC) / 9) - (t_MonRec_11.SumAC / t_MonRec_11.KursMC))) SumCurrDif FROM av_t_MonRec t_MonRec_11 WITH (NOLOCK)
INNER JOIN r_Ours r_Ours_28 WITH (NOLOCK) ON (r_Ours_28.OurID = t_MonRec_11.OurID)
INNER JOIN r_Codes1 r_Codes1_48 WITH (NOLOCK) ON (r_Codes1_48.CodeID1 = t_MonRec_11.CodeID1)
INNER JOIN r_Codes2 r_Codes2_58 WITH (NOLOCK) ON (r_Codes2_58.CodeID2 = t_MonRec_11.CodeID2)
INNER JOIN r_Codes3 r_Codes3_68 WITH (NOLOCK) ON (r_Codes3_68.CodeID3 = t_MonRec_11.CodeID3)
INNER JOIN r_Codes4 r_Codes4_78 WITH (NOLOCK) ON (r_Codes4_78.CodeID4 = t_MonRec_11.CodeID4)
INNER JOIN r_Codes5 r_Codes5_88 WITH (NOLOCK) ON (r_Codes5_88.CodeID5 = t_MonRec_11.CodeID5)  WHERE  ((t_MonRec_11.CodeID1 BETWEEN 2002 AND 2005) OR (t_MonRec_11.CodeID1 BETWEEN 2008 AND 2023) OR (t_MonRec_11.CodeID1 BETWEEN 2025 AND 2042) OR (t_MonRec_11.CodeID1 BETWEEN 2044 AND 2099) OR (t_MonRec_11.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_MonRec_11.CodeID4 BETWEEN 2000 AND 2029) OR (t_MonRec_11.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_MonRec_11.CodeID5 = 2006) OR (t_MonRec_11.CodeID5 = 2007) OR (t_MonRec_11.CodeID5 = 2008) OR (t_MonRec_11.CodeID5 = 2010) OR (t_MonRec_11.CodeID5 = 2018) OR (t_MonRec_11.CodeID5 = 2022)) AND ((t_MonRec_11.OurID BETWEEN 1 AND 5) OR (t_MonRec_11.OurID = 11)) AND (t_MonRec_11.DocDate BETWEEN '20180601' AND '20180630') AND (t_MonRec_11.OurID IN (1,11,2,3,5,6,4)) GROUP BY t_MonRec_11.OurID, r_Ours_28.OurName, t_MonRec_11.CodeID1, r_Codes1_48.CodeName1, t_MonRec_11.CodeID2, r_Codes1_48.Notes, r_Codes2_58.CodeName2, r_Codes2_58.Notes, t_MonRec_11.CodeID3, r_Codes3_68.CodeName3, r_Codes3_68.Notes, t_MonRec_11.CodeID4, r_Codes4_78.CodeName4, r_Codes4_78.Notes, t_MonRec_11.CodeID5, r_Codes5_88.CodeName5, r_Codes5_88.Notes, t_MonRec_11.DocDate

--5
>>> Расход (Факт) - Переоценка цен прихода (Расход):
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Est_156.OurID, r_Ours_159.OurName, r_Codes1_186.CodeID1, r_Codes1_186.CodeName1, r_Codes2_187.CodeID2, r_Codes1_186.Notes Notes1, r_Codes2_187.CodeName2, r_Codes2_187.Notes Notes2, t_Est_156.CodeID3, r_Codes3_162.CodeName3, r_Codes3_162.Notes Notes3, r_Codes4_194.CodeID4, r_Codes4_194.CodeName4, r_Codes4_194.Notes Notes4, r_Codes5_188.CodeID5, r_Codes5_188.CodeName5, r_Codes5_188.Notes Notes5, t_Est_156.DocDate, r_Deps_214.DepID, r_Deps_214.DepName, SUM(t_EstD_157.Qty * t_PInP_167.CostCC) SumCC, SUM(t_EstD_157.Qty * t_PInP_167.CostMC) SumMC, SUM((t_EstD_157.Qty * t_PInP_167.CostCC) / 9) SumMC_K, SUM(t_EstD_157.Qty * ((t_PInP_167.CostCC / 9) - t_PInP_167.CostMC)) SumCurrDif FROM av_t_Est t_Est_156 WITH (NOLOCK)
INNER JOIN av_t_EstD t_EstD_157 WITH (NOLOCK) ON (t_Est_156.ChID = t_EstD_157.ChID)
INNER JOIN r_Ours r_Ours_159 WITH (NOLOCK) ON (r_Ours_159.OurID = t_Est_156.OurID)
INNER JOIN r_Codes3 r_Codes3_162 WITH (NOLOCK) ON (r_Codes3_162.CodeID3 = t_Est_156.CodeID3)
INNER JOIN r_Stocks r_Stocks_191 WITH (NOLOCK) ON (r_Stocks_191.StockID = t_Est_156.StockID)
INNER JOIN t_PInP t_PInP_167 WITH (NOLOCK) ON (t_PInP_167.PPID = t_EstD_157.PPID) AND (t_PInP_167.ProdID = t_EstD_157.ProdID)
INNER JOIN r_Prods r_Prods_172 WITH (NOLOCK) ON (r_Prods_172.ProdID = t_PInP_167.ProdID)
INNER JOIN r_ProdC r_ProdC_173 WITH (NOLOCK) ON (r_ProdC_173.PCatID = r_Prods_172.PCatID)
INNER JOIN r_ProdG r_ProdG_174 WITH (NOLOCK) ON (r_ProdG_174.PGrID = r_Prods_172.PGrID)
INNER JOIN r_ProdG1 r_ProdG1_175 WITH (NOLOCK) ON (r_ProdG1_175.PGrID1 = r_Prods_172.PGrID1)
INNER JOIN r_Codes1 r_Codes1_186 WITH (NOLOCK) ON (r_Codes1_186.CodeID1 = r_ProdC_173.CodeID1)
INNER JOIN r_Codes2 r_Codes2_187 WITH (NOLOCK) ON (r_Codes2_187.CodeID2 = r_ProdG_174.CodeID2)
INNER JOIN r_Codes5 r_Codes5_188 WITH (NOLOCK) ON (r_Codes5_188.CodeID5 = r_ProdG1_175.CodeID5)
INNER JOIN r_StockGs r_StockGs_192 WITH (NOLOCK) ON (r_StockGs_192.StockGID = r_Stocks_191.StockGID)
INNER JOIN r_Deps r_Deps_214 WITH (NOLOCK) ON (r_Deps_214.DepID = r_Stocks_191.DepID)
INNER JOIN r_Codes4 r_Codes4_194 WITH (NOLOCK) ON (r_Codes4_194.CodeID4 = r_StockGs_192.StockGID)  WHERE  ((r_Codes1_186.CodeID1 BETWEEN 2002 AND 2005) OR (r_Codes1_186.CodeID1 BETWEEN 2008 AND 2023) OR (r_Codes1_186.CodeID1 BETWEEN 2025 AND 2042) OR (r_Codes1_186.CodeID1 BETWEEN 2044 AND 2099) OR (r_Codes1_186.CodeID1 BETWEEN 2101 AND 3001)) AND ((r_Codes4_194.CodeID4 BETWEEN 2000 AND 2029) OR (r_Codes4_194.CodeID4 BETWEEN 2100 AND 3000)) AND ((r_Codes5_188.CodeID5 = 2006) OR (r_Codes5_188.CodeID5 = 2007) OR (r_Codes5_188.CodeID5 = 2008) OR (r_Codes5_188.CodeID5 = 2010) OR (r_Codes5_188.CodeID5 = 2018) OR (r_Codes5_188.CodeID5 = 2022)) AND ((t_Est_156.OurID BETWEEN 1 AND 5) OR (t_Est_156.OurID = 11)) AND (t_Est_156.DocDate BETWEEN '20180601' AND '20180630') AND ((t_Est_156.OurID IN (1,11,2,3,5,6,4) AND (r_Prods_172.PCatID BETWEEN 600 AND 699) AND ((r_Prods_172.PGrID BETWEEN 9100 AND 9999) OR (r_Prods_172.PGrID BETWEEN 16000 AND 17000)))) GROUP BY t_Est_156.OurID, r_Ours_159.OurName, r_Codes1_186.CodeID1, r_Codes1_186.CodeName1, r_Codes2_187.CodeID2, r_Codes1_186.Notes, r_Codes2_187.CodeName2, r_Codes2_187.Notes, t_Est_156.CodeID3, r_Codes3_162.CodeName3, r_Codes3_162.Notes, r_Codes4_194.CodeID4, r_Codes4_194.CodeName4, r_Codes4_194.Notes, r_Codes5_188.CodeID5, r_Codes5_188.CodeName5, r_Codes5_188.Notes, t_Est_156.DocDate, r_Deps_214.DepID, r_Deps_214.DepName


>>> Расход (Факт) - Возврат товара по чеку:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_CRRet_195.OurID, r_Ours_199.OurName, t_CRRet_195.CodeID1, r_Codes1_202.CodeName1, t_CRRet_195.CodeID2, r_Codes1_202.Notes Notes1, r_Codes2_203.CodeName2, r_Codes2_203.Notes Notes2, t_CRRet_195.CodeID3, r_Codes3_206.CodeName3, r_Codes3_206.Notes Notes3, t_CRRet_195.CodeID4, r_Codes4_207.CodeName4, r_Codes4_207.Notes Notes4, t_CRRet_195.CodeID5, r_Codes5_210.CodeName5, r_Codes5_210.Notes Notes5, t_CRRet_195.DocDate, 0, '', SUM(0-(t_CRRetD_196.Qty * t_PInP_211.CostCC)) SumCC, SUM(0-(t_CRRetD_196.Qty * t_PInP_211.CostMC)) SumMC, SUM(0-(t_CRRetD_196.Qty * t_PInP_211.CostCC / 9)) SumMC_K, SUM(0-(t_CRRetD_196.Qty * (t_PInP_211.CostCC / 9 - t_PInP_211.CostMC))) SumCurrDif FROM av_t_CRRet t_CRRet_195 WITH (NOLOCK)
INNER JOIN av_t_CRRetD t_CRRetD_196 WITH (NOLOCK) ON (t_CRRet_195.ChID = t_CRRetD_196.ChID)
INNER JOIN r_Ours r_Ours_199 WITH (NOLOCK) ON (r_Ours_199.OurID = t_CRRet_195.OurID)
INNER JOIN r_Codes1 r_Codes1_202 WITH (NOLOCK) ON (r_Codes1_202.CodeID1 = t_CRRet_195.CodeID1)
INNER JOIN r_Codes2 r_Codes2_203 WITH (NOLOCK) ON (r_Codes2_203.CodeID2 = t_CRRet_195.CodeID2)
INNER JOIN r_Codes3 r_Codes3_206 WITH (NOLOCK) ON (r_Codes3_206.CodeID3 = t_CRRet_195.CodeID3)
INNER JOIN r_Codes4 r_Codes4_207 WITH (NOLOCK) ON (r_Codes4_207.CodeID4 = t_CRRet_195.CodeID4)
INNER JOIN r_Codes5 r_Codes5_210 WITH (NOLOCK) ON (r_Codes5_210.CodeID5 = t_CRRet_195.CodeID5)
INNER JOIN t_PInP t_PInP_211 WITH (NOLOCK) ON (t_PInP_211.PPID = t_CRRetD_196.PPID) AND (t_PInP_211.ProdID = t_CRRetD_196.ProdID)  WHERE  ((t_CRRet_195.CodeID1 BETWEEN 2002 AND 2005) OR (t_CRRet_195.CodeID1 BETWEEN 2008 AND 2023) OR (t_CRRet_195.CodeID1 BETWEEN 2025 AND 2042) OR (t_CRRet_195.CodeID1 BETWEEN 2044 AND 2099) OR (t_CRRet_195.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_CRRet_195.CodeID4 BETWEEN 2000 AND 2029) OR (t_CRRet_195.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_CRRet_195.CodeID5 = 2006) OR (t_CRRet_195.CodeID5 = 2007) OR (t_CRRet_195.CodeID5 = 2008) OR (t_CRRet_195.CodeID5 = 2010) OR (t_CRRet_195.CodeID5 = 2018) OR (t_CRRet_195.CodeID5 = 2022)) AND ((t_CRRet_195.OurID BETWEEN 1 AND 5) OR (t_CRRet_195.OurID = 11)) AND (t_CRRet_195.DocDate BETWEEN '20180601' AND '20180630') AND ((t_CRRet_195.OurID IN (1,11,2,3,5,6,4))) GROUP BY t_CRRet_195.OurID, r_Ours_199.OurName, t_CRRet_195.CodeID1, r_Codes1_202.CodeName1, t_CRRet_195.CodeID2, r_Codes1_202.Notes, r_Codes2_203.CodeName2, r_Codes2_203.Notes, t_CRRet_195.CodeID3, r_Codes3_206.CodeName3, r_Codes3_206.Notes, t_CRRet_195.CodeID4, r_Codes4_207.CodeName4, r_Codes4_207.Notes, t_CRRet_195.CodeID5, r_Codes5_210.CodeName5, r_Codes5_210.Notes, t_CRRet_195.DocDate


>>> Расход (Факт) - Продажа товара оператором:
INSERT INTO [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] ([GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [CodeID2], [Notes1], [CodeName2], [Notes2], [CodeID3], [CodeName3], [Notes3], [CodeID4], [CodeName4], [Notes4], [CodeID5], [CodeName5], [Notes5], [DocDate], [DDepID], [DDepName], [SumCC], [SumMC], [SumMC_K], [SumCurrDif]) SELECT 'Расход (Факт)', t_Sale_197.OurID, r_Ours_200.OurName, t_Sale_197.CodeID1, r_Codes1_201.CodeName1, t_Sale_197.CodeID2, r_Codes1_201.CodeID1 Notes1, r_Codes2_204.CodeName2, r_Codes2_204.Notes Notes2, t_Sale_197.CodeID3, r_Codes3_205.CodeName3, r_Codes3_205.Notes Notes3, t_Sale_197.CodeID4, r_Codes4_208.CodeName4, r_Codes4_208.Notes Notes4, t_Sale_197.CodeID5, r_Codes5_209.CodeName5, r_Codes5_209.Notes Notes5, t_Sale_197.DocDate, 0, '', SUM(t_SaleD_198.Qty * t_PInP_212.CostCC) SumCC, SUM(t_SaleD_198.Qty * t_PInP_212.CostMC) SumMC, SUM(t_SaleD_198.Qty * t_PInP_212.CostCC / 9) SumMC_K, SUM(t_SaleD_198.Qty * (t_PInP_212.CostCC / 9 - t_PInP_212.CostMC)) SumCurrDif FROM av_t_Sale t_Sale_197 WITH (NOLOCK)
INNER JOIN av_t_SaleD t_SaleD_198 WITH (NOLOCK) ON (t_Sale_197.ChID = t_SaleD_198.ChID)
INNER JOIN r_Ours r_Ours_200 WITH (NOLOCK) ON (r_Ours_200.OurID = t_Sale_197.OurID)
INNER JOIN r_Codes1 r_Codes1_201 WITH (NOLOCK) ON (r_Codes1_201.CodeID1 = t_Sale_197.CodeID1)
INNER JOIN r_Codes2 r_Codes2_204 WITH (NOLOCK) ON (r_Codes2_204.CodeID2 = t_Sale_197.CodeID2)
INNER JOIN r_Codes3 r_Codes3_205 WITH (NOLOCK) ON (r_Codes3_205.CodeID3 = t_Sale_197.CodeID3)
INNER JOIN r_Codes4 r_Codes4_208 WITH (NOLOCK) ON (r_Codes4_208.CodeID4 = t_Sale_197.CodeID4)
INNER JOIN r_Codes5 r_Codes5_209 WITH (NOLOCK) ON (r_Codes5_209.CodeID5 = t_Sale_197.CodeID5)
INNER JOIN t_PInP t_PInP_212 WITH (NOLOCK) ON (t_PInP_212.PPID = t_SaleD_198.PPID) AND (t_PInP_212.ProdID = t_SaleD_198.ProdID)  WHERE  ((t_Sale_197.CodeID1 BETWEEN 2002 AND 2005) OR (t_Sale_197.CodeID1 BETWEEN 2008 AND 2023) OR (t_Sale_197.CodeID1 BETWEEN 2025 AND 2042) OR (t_Sale_197.CodeID1 BETWEEN 2044 AND 2099) OR (t_Sale_197.CodeID1 BETWEEN 2101 AND 3001)) AND ((t_Sale_197.CodeID4 BETWEEN 2000 AND 2029) OR (t_Sale_197.CodeID4 BETWEEN 2100 AND 3000)) AND ((t_Sale_197.CodeID5 = 2006) OR (t_Sale_197.CodeID5 = 2007) OR (t_Sale_197.CodeID5 = 2008) OR (t_Sale_197.CodeID5 = 2010) OR (t_Sale_197.CodeID5 = 2018) OR (t_Sale_197.CodeID5 = 2022)) AND ((t_Sale_197.OurID BETWEEN 1 AND 5) OR (t_Sale_197.OurID = 11)) AND (t_Sale_197.DocDate BETWEEN '20180601' AND '20180630') AND ((t_Sale_197.OurID IN (1,11,2,3,5,6,4))) GROUP BY t_Sale_197.OurID, r_Ours_200.OurName, t_Sale_197.CodeID1, r_Codes1_201.CodeName1, t_Sale_197.CodeID2, r_Codes1_201.CodeID1, r_Codes2_204.CodeName2, r_Codes2_204.Notes, t_Sale_197.CodeID3, r_Codes3_205.CodeName3, r_Codes3_205.Notes, t_Sale_197.CodeID4, r_Codes4_208.CodeName4, r_Codes4_208.Notes, t_Sale_197.CodeID5, r_Codes5_209.CodeName5, r_Codes5_209.Notes, t_Sale_197.DocDate

SELECT [GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [Notes1], [Notes2], [CodeID5], [CodeName5], [Notes5], SUM([SumMC]) AS [SumMC] FROM [AzTempDB].[CONST\rumyantsev].[v_014_00449_1_CONST\rumyantsev] GROUP BY [GMSSourceGroup], [OurID], [OurName], [CodeID1], [CodeName1], [Notes1], [Notes2], [CodeID5], [CodeName5], [Notes5]
