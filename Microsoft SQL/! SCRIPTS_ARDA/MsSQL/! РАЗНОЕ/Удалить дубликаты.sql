USE ElitR_test;
BEGIN TRAN
DECLARE @BDiap INT= 1700000000, @EDiap INT= 1799999999;

--SELECT * FROM [S-SQL-D4].ElitR_test.DBO.t_MonRec m WHERE m.ChID BETWEEN @BDiap AND @EDiap AND DocID IN (1700003386,1700003066,1700003389,1700003417,1700003340,00005225,1700003572,1700005158)
SELECT * FROM t_MonRec m WHERE m.ChID BETWEEN @BDiap AND @EDiap AND DocID IN (1700003386,1700003066,1700003389,1700003417,1700003340,00005225,1700003572,1700005158)

SELECT FROM t_MonRec 
LEFT OUTER JOIN (
   SELECT MIN(DocID) 
   FROM t_MonRec 
   GROUP BY DocID
) as KeepRows ON
   t_MonRec.DocID = KeepRows.DocID
WHERE
   KeepRows.DocID IS NULL

ROLLBACK TRAN

--SELECT count(DISTINCT dociD) FROM t_MonRec



-----------------------------
BEGIN TRAN;
DECLARE @BDiap INT= 1700000000, @EDiap INT= 1799999999;

--SELECT * FROM t_MonRec m WHERE m.ChID BETWEEN @BDiap AND @EDiap AND DocID IN (1700003386,1700003066,1700003389,1700003417,1700003340,00005225,1700003572,1700005158)

SELECT DISTINCT 
       *
INTO t_MonRec2
FROM t_MonRec m WHERE m.ChID BETWEEN @BDiap AND @EDiap;
DELETE FROM t_MonRec;
INSERT INTO t_MonRec
	SELECT
		*
	FROM t_MonRec2;
DROP TABLE t_MonRec2;
ROLLBACK TRAN;


