<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39637.5603683796" ReportOptions.Description.Text="" ReportOptions.LastChange="42248.5726268171" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  s: string;&#13;&#10;  CForm: string;&#13;&#10;  RegPath: string = 'Отчеты\Торговля\Элитка - Акт Сверки';&#13;&#10;  CompActive: boolean;&#13;&#10;  CopyNum: Integer;                           &#13;&#10;&#13;&#10;{--------------------Общие Процедуры-------------------------------------------}&#13;&#10;procedure RefreshEmps(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  TmpEmp: Integer;&#13;&#10;begin&#13;&#10;  TmpEmp := 0;&#13;&#10;  if ctl_Dir.Enabled then&#13;&#10;  begin&#13;&#10;    if dq_Emps.Active and not dq_Emps.IsEmpty and (ctl_Dir.KeyValue &#60;&#62; null) then&#13;&#10;      TmpEmp := ctl_Dir.KeyValue;&#13;&#10;    dq_Emps.Close;&#13;&#10;    dq_Emps.Open;&#13;&#10;    if dq_Emps.Active and not dq_Emps.IsEmpty then&#13;&#10;      if dq_Emps.Dataset.Locate('EmpID', TmpEmp, loCaseInsensitive) then&#13;&#10;        ctl_Dir.KeyValue := TmpEmp&#13;&#10;      else&#13;&#10;        ctl_Dir.KeyValue := dq_Emps.Fields[0].Value;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    if dq_Emps.Active then dq_Emps.Close;&#13;&#10;    dq_Emps.Open;&#13;&#10;    dq_Emps.Dataset.Locate('AttorID', 0, loCaseInsensitive);&#13;&#10;    ctl_Dir.KeyValue := dq_Emps.Fields[0].Value;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure MoreOkOnClick;&#13;&#10;begin&#13;&#10;  if rbCompFilter.Checked and ((Trim(Comps.Text) = '') or (PoS(',', Comps.Text) + PoS('-', Comps.Text) &#62; 0)) then&#13;&#10;  begin&#13;&#10;    dlg_Filter.ModalResult := 0;&#13;&#10;    RaiseException('Для расчета акта сверки необходимо выбрать одно предприятие!');&#13;&#10;  end;&#13;&#10;  if (ctl_Dir.Text = '') and rbCompFilter.Checked then&#13;&#10;  begin&#13;&#10;    dlg_Filter.ModalResult := 0;&#13;&#10;    RaiseException('Для расчета акта сверки необходимо выбрать представителя фирмы!');&#13;&#10;  end;&#13;&#10;  if ctl_Start.Date &#60; EncodeDate(2015,1,1) then&#13;&#10;  begin&#13;&#10;    dlg_Filter.ModalResult := 0;&#13;&#10;    RaiseException('Начальная дата расчёта отчёта не может быть меньше 01.01.2015 г.!');&#13;&#10;  end;&#13;&#10;&#13;&#10;  if Int(ctl_End.Date) &#60; Int(ctl_Start.Date) then&#13;&#10;  begin&#13;&#10;    dlg_Filter.ModalResult := 0;&#13;&#10;    RaiseException('&#34;Конечная дата&#34; расчёта не должна быть меньше &#34;Начальной даты&#34;!');&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;{------------------ dlg_Filter: TfrxDialogPage --------------------------------}&#13;&#10;&#13;&#10;procedure dlg_FilterOnShow(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  AEmpID: integer;&#13;&#10;begin&#13;&#10;  // Открываем источники данных&#13;&#10;  cbOurs.DataSet.Open;&#13;&#10;  ctl_Dir.DataSet.Open;&#13;&#10;  cbSRs.DataSet.Open;&#13;&#10;  // Загружаем настройки&#13;&#10;  Ctl_Start.Date := StrToInt(Реестр_Прочитать('Ctl_Start', IntToStr(Trunc(EncodeDate(YearOf(Now),1,1))), RegPath));&#13;&#10;  Ctl_End.Date := StrToInt(Реестр_Прочитать('Ctl_End', IntToStr(Trunc(EncodeDate(YearOf(Now),12,31))), RegPath));&#13;&#10;  cbOurs.KeyValue := Реестр_Прочитать('AOurID', VarToStr(БДФункция('zf_GetOurID', 't')), RegPath);&#13;&#10;  Comps.Text := Реестр_Прочитать('ACompID', '0', RegPath);&#13;&#10;  CompsOnExit(Sender);&#13;&#10;  Codes1.Text := Реестр_Прочитать('c1', '', RegPath);&#13;&#10;  Codes2.Text := Реестр_Прочитать('c2', '', RegPath);&#13;&#10;  Codes3.Text := Реестр_Прочитать('c3', '2,5', RegPath);&#13;&#10;  rbCompFilter.Checked := StrToBool(Реестр_Прочитать('rbCompFilter', '1', RegPath));&#13;&#10;  rbSRFilter.Checked := StrToBool(Реестр_Прочитать('rbSRFilter', '0', RegPath));&#13;&#10;  cbSRs.KeyValue := StrToInt(Реестр_Прочитать('cbSRs', '-1', RegPath));&#13;&#10;  cbWithDataOnly.Checked := StrToBool(Реестр_Прочитать('cbWithDataOnly', '1', RegPath));&#13;&#10;  ctl_IsConsCode.Checked := StrToBool(Реестр_Прочитать('IsConsCode', '0', RegPath));&#13;&#10;  ctl_IsConsCodeOnClick(Sender);&#13;&#10;  ctl_IsGroupData.Checked := StrToBool(Реестр_Прочитать('IsGroupData', '1', RegPath));&#13;&#10;  ctlSegmPrint.Checked := StrToBool(Реестр_Прочитать('SegmPrint', '1', RegPath));&#13;&#10;  cb_DirMode.Checked := StrToBool(Реестр_Прочитать('Dir', '0', RegPath));&#13;&#10;&#13;&#10;  cb_DirModeOnClick(Sender);&#13;&#10;  cb_PrintNum.Checked := StrToBool(Реестр_Прочитать('cb_PrintNum', '1', RegPath));&#13;&#10;  cb_PrintNumOnClick(Report);&#13;&#10;  //Loading username&#13;&#10;  AEmpID := StrToInt(Реестр_Прочитать('EmpID', '0', RegPath));&#13;&#10;  if dq_Emps.Dataset.Locate('EmpID', AEmpID, loCaseInsensitive) then&#13;&#10;    ctl_Dir.KeyValue := AEmpID;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ctl_PeriodOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  p: string;&#13;&#10;begin&#13;&#10;  p := ВыборПериода(ctl_Start.Date, ctl_Start.Date, 0);&#13;&#10;  if p &#60;&#62; '' then&#13;&#10;  begin&#13;&#10;    ctl_Start.Date := StrToDate(ПараметрИзСтроки(1, p, ';'));&#13;&#10;    ctl_End.Date := StrToDate(ПараметрИзСтроки(2, p, ';'));&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cb_PrintNumOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  ctl_Num.Enabled := cb_PrintNum.Checked and rbCompFilter.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ctl_IsConsCodeOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  cb_DirMode.Checked := ctl_IsConsCode.Checked;&#13;&#10;  cb_DirMode.Enabled := not ctl_IsConsCode.Checked;&#13;&#10;  cb_DirModeOnClick(Sender);&#13;&#10;  CompsOnChange(Sender);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cb_DirModeOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  ctl_Dir.Enabled := not cb_DirMode.Checked and not ctl_IsConsCode.Checked;&#13;&#10;  RefreshEmps(Sender);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CodeID1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes1.Text := ВыборСпискаИзСправочника('r_Codes1;CodeID1;CodeName1;' + Codes1.Text);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CodeID2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes2.Text := ВыборСпискаИзСправочника('r_Codes2;CodeID2;CodeName2;' + Codes2.Text);&#13;&#10;end;  &#13;&#10;&#13;&#10;procedure CodeID3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes3.Text := ВыборСпискаИзСправочника('r_Codes3;CodeID3;CodeName3;' + Codes3.Text);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;&#13;&#10;{------------------- Comps: TfrxEditControl ----------------------------------}&#13;&#10;&#13;&#10;procedure CompIDOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Comps.Text := ПараметрИзСтроки(1, ВыборСпискаИзСправочника('r_Comps;CompID;CompName;' + Comps.Text), ',');&#13;&#10;  RefreshEmps(Sender);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompsOnEnter(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CompActive := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompsOnChange(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  CName: Variant;&#13;&#10;begin&#13;&#10;  CName := null;&#13;&#10;  if Comps.Text &#60;&#62; '' then&#13;&#10;  try&#13;&#10;    if not ctl_IsConsCode.Checked then&#13;&#10;      CName := БДПоиск('MIN(CompName)', 'dbo.r_Comps', 'CompID=' + IntToStr(StrToInt(Comps.Text)))&#13;&#10;    else&#13;&#10;      CName := БДПоиск('MIN(CompName)',&#13;&#10;        'dbo.r_Comps a WITH(NOLOCK) LEFT JOIN dbo.at_r_CompOurTerms b WITH(NOLOCK) ON b.CompID = a.CompID',&#13;&#10;        'b.BCompCode = ' + IntToStr(StrToInt(Comps.Text)) + ' AND b.OurID = ' + dq_Ours.FieldByName('OurID').AsString);&#13;&#10;  except&#13;&#10;  end;&#13;&#10;&#13;&#10;  if CName = null then&#13;&#10;  begin&#13;&#10;    CName := '&#60;Нет предприятия&#62;';&#13;&#10;    CompName.Font.Color := clRed;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    CompName.Font.Color := clWindowText;&#13;&#10;&#13;&#10;  CompName.Text := CName;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompsOnExit(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CompActive := False;&#13;&#10;  RefreshEmps(Sender);&#13;&#10;  if rbCompFilter.Checked then&#13;&#10;    ctl_Num.Text := Trim(Comps.Text)&#13;&#10;  else if rbSRFilter.Checked then&#13;&#10;    ctl_Num.Text := '&#60;Код предприятия&#62;';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompsOnKeyPress(Sender: TfrxComponent; var Key: Char);&#13;&#10;begin&#13;&#10;  if not (Key in ['0'..'9', #8, #13]) then Key := #0;&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;{-------------------------- Выбор типа фильтра --------------------------------}&#13;&#10;procedure rbCompFilterOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  pCompFilter.Left := gbMainFilter.Left + 7;&#13;&#10;  pSRFilter.Left := dlg_Filter.ClientWidth + 7;&#13;&#10;  ctl_Num.Enabled := rbCompFilter.Checked;&#13;&#10;  CompsOnExit(Sender);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbSRFilterOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  pSRFilter.Left := gbMainFilter.Left + 7;&#13;&#10;  pCompFilter.Left := dlg_Filter.ClientWidth + 7;&#13;&#10;  ctl_Num.Enabled := rbCompFilter.Checked;&#13;&#10;  if ctl_IsConsCode.Checked then                        &#13;&#10;    ctl_IsConsCode.Checked := False;      &#13;&#10;  CompsOnExit(Sender);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;{------------------ Процедуры формирования акта сверки ------------------------}&#13;&#10;&#13;&#10;procedure ctl_OkOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  s1: string;&#13;&#10;  AFilter: string;&#13;&#10;begin&#13;&#10;  if CompActive then&#13;&#10;    CompsOnExit(Sender);&#13;&#10;  RefreshEmps(Sender);&#13;&#10;&#13;&#10;  MoreOkOnClick;&#13;&#10;  Реестр_Записать('IsConsCode', BoolToStr(ctl_IsConsCode.Checked), RegPath);&#13;&#10;  Реестр_Записать('IsGroupData', BoolToStr(ctl_IsGroupData.Checked), RegPath);&#13;&#10;  Реестр_Записать('cb_PrintNum', BoolToStr(cb_PrintNum.Checked), RegPath);&#13;&#10;  Реестр_Записать('rbCompFilter', BoolToStr(rbCompFilter.Checked), RegPath);&#13;&#10;  Реестр_Записать('rbSRFilter', BoolToStr(rbSRFilter.Checked), RegPath);&#13;&#10;  Реестр_Записать('cbWithDataOnly', BoolToStr(cbWithDataOnly.Checked), RegPath);&#13;&#10;  Реестр_Записать('cbSRs', IntToStr(cbSRs.KeyValue), RegPath);&#13;&#10;  Реестр_Записать('SegmPrint', BoolToStr(ctlSegmPrint.Checked), RegPath);&#13;&#10;  Реестр_Записать('Ctl_Start', IntToStr(Trunc(Ctl_Start.Date)), RegPath);&#13;&#10;  Реестр_Записать('Ctl_End', IntToStr(Trunc(Ctl_End.Date)), RegPath);&#13;&#10;  Реестр_Записать('AOurID', IntToStr(cbOurs.KeyValue), RegPath);&#13;&#10;  Реестр_Записать('ACompID', Comps.Text, RegPath);&#13;&#10;  Реестр_Записать('c1', Codes1.Text, RegPath);&#13;&#10;  Реестр_Записать('c2', Codes2.Text, RegPath);&#13;&#10;  Реестр_Записать('c3', Codes3.Text, RegPath);&#13;&#10;  Реестр_Записать('Dir', BoolToStr(cb_DirMode.Checked), RegPath);&#13;&#10;  if ctl_Dir.Enabled then Реестр_Записать('EmpID', IntToStr(ctl_Dir.KeyValue), RegPath);&#13;&#10;&#13;&#10;  // Формируем строку фильтра&#13;&#10;  AFilter := 'AND OurID = ' + dq_Ours.Fields[0].AsString;&#13;&#10;  // Если выбран фильтр по предприятию, лепим предприятяие&#13;&#10;  if rbCompFilter.Checked then&#13;&#10;  begin&#13;&#10;    if ctl_IsConsCode.Checked then&#13;&#10;      AFilter := AFilter + ' AND EXISTS (SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND ' + IntToStr(StrToInt(Comps.Text)) + ' = BCompCode)'&#13;&#10;    else&#13;&#10;      AFilter := AFilter + ' AND CompID = ' + IntToStr(StrToInt(Comps.Text));&#13;&#10;  end&#13;&#10;  // Если выбран ТП, лепим ТП&#13;&#10;  else if rbSRFilter.Checked then&#13;&#10;      AFilter := AFilter + ' AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID ' +&#13;&#10;      'AND ' + dq_Ours.Fields[0].AsString + ' = OurID ' +&#13;&#10;      'AND ' + dq_SRs.FieldByName('SRID').AsString + ' = SRID)';&#13;&#10;  // Доклеиваем всё остальное&#13;&#10;  if Trim(Codes1.Text) &#60;&#62; '' then&#13;&#10;    AFilter := AFilter + ' AND (' + СписокВУсловиеSQL('CodeID1', Codes1.Text) + ')';&#13;&#10;  if Trim(Codes2.Text) &#60;&#62; '' then&#13;&#10;    AFilter := AFilter + ' AND (' + СписокВУсловиеSQL('CodeID2', Codes2.Text) + ')';&#13;&#10;  if Trim(Codes3.Text) &#60;&#62; '' then&#13;&#10;    AFilter := AFilter + ' AND (' + СписокВУсловиеSQL('CodeID3', Codes3.Text) + ')';&#13;&#10;&#13;&#10;  // Применим фильтр для запросов&#13;&#10;  dq_Doc.SQL.Text := ReplaceStr(dq_Doc.SQL.Text, '/* Filter */', AFilter);&#13;&#10;  dq_DocD.SQL.Text := ReplaceStr(dq_DocD.SQL.Text, '/* Filter */', AFilter);&#13;&#10;&#13;&#10;  // Подготовка запроса dq_Doc на основаниии параметров печати&#13;&#10;  if ctl_IsConsCode.Checked then&#13;&#10;    dq_Doc.SQL.Text := ReplaceStr(dq_Doc.SQL.Text, 'FLDNAME2', 'CompID')&#13;&#10;  else&#13;&#10;    dq_Doc.SQL.Text := ReplaceStr(dq_Doc.SQL.Text, 'FLDNAME1', 'CompID');&#13;&#10;&#13;&#10;  // Если акт с группировкой, меняем наименование типа операции&#13;&#10;  if ctl_IsGroupData.Checked then&#13;&#10;  begin&#13;&#10;    dq_DocD.SQL.Text := ReplaceStr(dq_DocD.SQL.Text, '''Оплата''', '''Реалізація та оплата''');&#13;&#10;    dq_DocD.SQL.Text := ReplaceStr(dq_DocD.SQL.Text, '''Повернення''', '''Реалізація та оплата''');&#13;&#10;    dq_DocD.SQL.Text := ReplaceStr(dq_DocD.SQL.Text, '''Реалізація''', '''Реалізація та оплата''');&#13;&#10;  end;&#13;&#10;&#13;&#10;  // ПОЛУЧИМ ДАННЫЕ ДЛЯ ШАПКИ&#13;&#10;  // получим форму оплаты&#13;&#10;  try&#13;&#10;    dq_Run.SQL.Text := 'SELECT DISTINCT CForm FROM r_Codes3 WITH(NOLOCK) WHERE ' + СписокВУсловиеSQL('CodeID3', Codes3.Text);&#13;&#10;    try&#13;&#10;      dq_Run.Open;&#13;&#10;    except&#13;&#10;    end;&#13;&#10;&#13;&#10;    if not dq_Run.IsEmpty then&#13;&#10;    begin&#13;&#10;      if dq_Run.RecordCount &#62; 1 then&#13;&#10;        CForm := '1,2'&#13;&#10;      else&#13;&#10;        CForm := dq_Run.Fields[0].AsString;&#13;&#10;    end&#13;&#10;    else CForm := '1,2';&#13;&#10;  finally&#13;&#10;    dq_Run.Close;&#13;&#10;  end;&#13;&#10;&#13;&#10;  //Печать сегмента&#13;&#10;  Memo1.Visible := ctlSegmPrint.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnManualBuild(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  i: Integer;                                  &#13;&#10;begin&#13;&#10;  while not bndm_Doc.DataSet.Eof do&#13;&#10;  begin&#13;&#10;    bndd_Doc.DataSet.Open;&#13;&#10;    for i := 1 to (cbCopyCnt.ItemIndex + 1) do       &#13;&#10;    begin                              &#13;&#10;      dq_DocD.First;&#13;&#10;      CopyNum := i;&#13;&#10;      // Если не убираем пустые или фильтр по предприятиям                                                                                                                                      &#13;&#10;      if not (cbWithDataOnly.Checked and rbSRFilter.Checked)&#13;&#10;      // Или убираем пустые и фильтр по ТП и есть движение                                                                                                                                &#13;&#10;      or ((cbWithDataOnly.Checked and rbSRFilter.Checked) and not (dq_DocD.IsEmpty))&#13;&#10;      // Или убираем пустые и фильтр по ТП и есть сальдо                &#13;&#10;      or ((cbWithDataOnly.Checked and rbSRFilter.Checked) and ((dq_Doc.FieldByName('BCSaldo').Value +&#13;&#10;        dq_Doc.FieldByName('BDSaldo').Value  &#62; 0.01) or              &#13;&#10;        (dq_Doc.FieldByName('ECSaldo').Value +&#13;&#10;        dq_Doc.FieldByName('EDSaldo').Value &#62; 0.01)))&#13;&#10;      then&#13;&#10;      with Engine do&#13;&#10;      begin&#13;&#10;        ShowBand(bndm_Doc);&#13;&#10;&#13;&#10;        ShowBand(Child1);&#13;&#10;        ShowBand(Child2);&#13;&#10;&#13;&#10;        while not bndd_Doc.DataSet.Eof do&#13;&#10;        begin&#13;&#10;          if FreeSpace &#60;= bndd_Doc.Height then ShowBand(Child1);&#13;&#10;          ShowBand(bndd_Doc);&#13;&#10;          bndd_Doc.DataSet.Next;&#13;&#10;        end;&#13;&#10;&#13;&#10;        ShowBand(bndf_Doc);&#13;&#10;        ShowBand(Child3);&#13;&#10;        ShowBand(Child4);&#13;&#10;        // Если не достигли нужного кол-ва копий                                                                                                                                      &#13;&#10;        if (i &#60; (cbCopyCnt.ItemIndex + 2)) and&#13;&#10;        // И это не последняя копия на последнем акте                                                                                                                         &#13;&#10;          not ((i = (cbCopyCnt.ItemIndex + 1)) and (bndm_Doc.DataSet.RecNo = bndm_Doc.DataSet.RecordCount - 1)) then&#13;&#10;        // Готовим новую страницу                                                                 &#13;&#10;          Engine.NewPage;&#13;&#10;      end;        &#13;&#10;    end;&#13;&#10;&#13;&#10;    bndd_Doc.DataSet.Close;        &#13;&#10;    bndm_Doc.DataSet.Next;                         &#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Child1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Memo10.Height &#62; Memo11.Height then&#13;&#10;  begin&#13;&#10;    Memo11.Height := Memo10.Height;&#13;&#10;    Memo14.Top := Memo12.Top;&#13;&#10;    Memo15.Top := Memo12.Top;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    Memo10.Height := Memo11.Height;&#13;&#10;    Memo12.Top := Memo14.Top;&#13;&#10;    Memo13.Top := Memo14.Top;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  dlg_Filter.ClientWidth := ctl_Ok.Left + ctl_Ok.Width + 3;&#13;&#10;  //dq_Emps.Query.AfterScroll := 'DSAfterOpen';      &#13;&#10;end." StoreInDFM="False" PropData="044C656674022803546F70020F0844617461736574730101062820446174615365743D2264715F456D70732220446174615365744E616D653D2264715F456D7073220001062820446174615365743D2264715F446F63442220446174615365744E616D653D2264715F446F6344220001062620446174615365743D2264715F52756E2220446174615365744E616D653D2264715F52756E220001062820446174615365743D2264715F4F7572732220446174615365744E616D653D2264715F4F757273220001062620446174615365743D2264715F446F632220446174615365744E616D653D2264715F446F63220001062620446174615365743D2264715F5372732220446174615365744E616D653D2264715F537273220000095661726961626C657301010616204E616D653D22204E65772043617465676F7279312200010625204E616D653D224F6666696365546F6F6C7346696C74657233222056616C75653D2227272200010625204E616D653D224F6666696365546F6F6C7346696C74657231222056616C75653D2227272200010625204E616D653D224F6666696365546F6F6C7346696C74657234222056616C75653D222727220000055374796C650100">
  <TfrxDataPage Name="Data" Height="256" Left="0" Top="0" Width="256">
    <TfrxBDEQuery Name="dq_Emps" UserName="dq_Emps" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="dq_Srs" IgnoreDupParams="True" SQL.Text="SELECT DISTINCT&#13;&#10;e.EmpID, e.UAEmpName EmpName, oo.AttorID, oo.AttorDate&#13;&#10;FROM dbo.at_r_OurOfficials oo WITH(NOLOCK)&#13;&#10;JOIN dbo.r_Emps e WITH(NOLOCK) ON e.EmpID = oo.EmpID&#13;&#10;WHERE &#13;&#10;oo.OurID = :AOurID&#13;&#10;AND&#13;&#10;/* Если выбран директор */&#13;&#10;(&#13;&#10;  (oo.AttorID = 0 AND 1 = :AFlag)&#13;&#10;OR /* Если фильтр по предприятию*/&#13;&#10;  (oo.CompGrID2 = (SELECT CompGrID2 FROM dbo.r_Comps c WITH(NOLOCK) WHERE c.CompID = :ACompID) AND 0 = :SRFilter AND 0 = :AFlag)&#13;&#10;OR /* Если фильтр по торговому */&#13;&#10;  (:MultiReg = 0 AND 0 = :AFlag           &#13;&#10;  AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms ot WITH(NOLOCK) JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID = ot.CompID WHERE oo.CompGrID2 = rc.CompGrID2 AND ot.OurID = :AOurID AND ot.SRID = :SRID) AND 1 = :SRFilter)&#13;&#10;)  &#13;&#10;ORDER BY 2" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667402240470546F7002500A506172616D657465727301010652204E616D653D22414F75724944222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B64715F4F7572732E262333343B4F75724944262333343B262336323B2200010677204E616D653D2241466C6167222044617461547970653D226674426F6F6C65616E222045787072657373696F6E3D222863746C5F4973436F6E73436F64652E436865636B656420616E64207262436F6D7046696C7465722E436865636B656429204F722063625F4469724D6F64652E436865636B6564220001067A204E616D653D2241436F6D704944222044617461547970653D226674496E7465676572222045787072657373696F6E3D224949462828436F6D70732E546578743D272729206F72206E6F74207262436F6D7046696C7465722E436865636B6564202C302C537472546F496E7428436F6D70732E5465787429292200010645204E616D653D22535246696C746572222044617461547970653D226674426F6F6C65616E222045787072657373696F6E3D227262535246696C7465722E436865636B65642200011467010000204E616D653D224D756C7469526567222044617461547970653D226674426F6F6C65616E222045787072657373696F6E3D2228D091D094D09FD0BED0B8D181D0BA282731272C2764626F2E61745F725F436F6D704F75725465726D73206F742057495448284E4F4C4F434B29204A4F494E2064626F2E725F436F6D70732072632057495448284E4F4C4F434B29204F4E2072632E436F6D704944203D206F742E436F6D704944205748455245206F742E4F75724944203D2027202B20566172546F53747228262336303B64715F4F7572732E262333343B4F75724944262333343B262336323B29202B202720414E44206F742E53524944203D2027202B20566172546F53747228262336303B64715F5372732E262333343B53524944262333343B262336323B29202B20272047524F5550204259206F742E5352494420484156494E4720434F554E54282A29203D2031272C27272920262336303B262336323B206E756C6C29220001064E204E616D653D2253524944222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B64715F5372732E262333343B53524944262333343B262336323B220000"/>
    <TfrxBDEQuery Name="dq_DocD" UserName="dq_DocD" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="dq_Doc" IgnoreDupParams="True" SQL.Text="SELECT DocDate, DocID, TaxDocID, DocName, SUM(ISNULL(DSumCC,0)) DSumCC, SUM(ISNULL(CSumCC,0)) CSumCC&#13;&#10;FROM (&#13;&#10;SELECT 'Прихід' DocName, DocDate, DocID, TaxDocID, TSumCC_wt*KursCC CSumCC, 0 DSumCC, 0 ChID FROM av_t_Rec m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Повернення', DocDate, DocID, TaxDocID, TSumCC_wt*KursCC, 0, 0 FROM av_t_Ret m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Реалізація', DocDate, DocID, TaxDocID, 0, TSumCC_wt*KursCC, 0 FROM av_t_Inv m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Реалізація', DocDate, DocID, TaxDocID, 0, TSumCC_wt*KursCC, 0 FROM av_t_Exp m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Реалізація', DocDate, DocID, TaxDocID, 0, TSumCC_wt*KursCC, 0 FROM av_t_Epp m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Оплата', DocDate, DocID, 0, SumAC*KursCC, 0, ChID FROM av_t_MonRec m WHERE SumAC&#62;0 AND DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Оплата', DocDate, DocID, 0, 0, -SumAC*KursCC, ChID FROM av_t_MonRec m WHERE SumAC&#60;0 AND DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Оплата', DocDate, DocNum, 0, SumAC*KursCC, 0, ChID FROM av_c_CompRec m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Оплата', DocDate, DocNum, 0, 0, SumAC*KursCC, ChID FROM av_c_CompExp m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Переведення основного боргу', DocDate,  DocID, 0, SumAC*KursCC, 0, ChID FROM av_c_CompCor m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */ UNION ALL&#13;&#10;SELECT 'Переведення штрафних санкцій', DocDate, DocID, 0, 0, SumAC*KursCC, ChID FROM av_c_PlanRec m WHERE DocDate BETWEEN :BDate AND :EDate AND ((0 = :Cons AND m.CompID = :CompID) OR (1 = :Cons AND EXISTS(SELECT * FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID AND BCompCode = :CompID))) /* Filter */&#13;&#10;) data&#13;&#10;GROUP BY DocDate, DocID, TaxDocID, DocName&#13;&#10;HAVING SUM(ISNULL(DSumCC,0)) &#60;&#62; 0 OR SUM(ISNULL(CSumCC,0)) &#60;&#62; 0&#13;&#10;ORDER BY DocDate, TaxDocID" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667403A0000470546F7002500A506172616D657465727301010644204E616D653D224244617465222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22496E742863746C5F53746172742E44617465292200010642204E616D653D224544617465222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22496E742863746C5F456E642E4461746529220001065E204E616D653D22436F6E73222044617461547970653D226674426F6F6C65616E222045787072657373696F6E3D2263746C5F4973436F6E73436F64652E436865636B656420616E64207262436F6D7046696C7465722E436865636B65642200010623204E616D653D22436F6D704944222044617461547970653D226674496E7465676572220000"/>
    <TfrxBDEQuery Name="dq_Run" UserName="dq_Run" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667403A0000470546F700394000A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_Ours" UserName="dq_Ours" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT OurID, CAST(OurID AS VARCHAR(10)) + ' - ' + OurName OurName, Note2 RealName&#13;&#10;FROM dbo.r_Ours WITH(NOLOCK)&#13;&#10;WHERE OurID IN (SELECT AValue FROM dbo.af_GetValidsTable('ValidOurs'))&#13;&#10;ORDER BY 1" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667402240470546F700398000A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_Doc" UserName="dq_Doc" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="True" SQL.Text="SELECT data.CompID, CASE WHEN SUM(BCSaldo) &#62; SUM(BDSaldo) THEN SUM(BCSaldo) - SUM(BDSaldo) ELSE 0 END BCSaldo,&#13;&#10;CASE WHEN SUM(BCSaldo) &#62; SUM(BDSaldo) THEN 0 ELSE SUM(BDSaldo) - SUM(BCSaldo) END BDSaldo,&#13;&#10;CASE WHEN SUM(ECSaldo) &#62; SUM(EDSaldo) THEN SUM(ECSaldo) - SUM(EDSaldo) ELSE 0 END ECSaldo,&#13;&#10;CASE WHEN SUM(ECSaldo) &#62; SUM(EDSaldo) THEN 0 ELSE SUM(EDSaldo) - SUM(ECSaldo) END EDSaldo,&#13;&#10;/* Реквизиты шапки */&#13;&#10;LTRIM(RTRIM(ISNULL(NULLIF(LTRIM(RTRIM(rc.Contract2)),''), rc.Contract1))) CompName,&#13;&#10;rc.Job3, '/ '  + srs.SRName EmpName,&#13;&#10;CAST((SELECT COUNT(*) FROM dbo.at_z_ContractsAdd zca WITH(NOLOCK) WHERE zca.HaveSeal = 1 AND zca.ChID = (SELECT TOP 1 ChID FROM dbo.at_z_Contracts WITH(NOLOCK) WHERE CompID = data.CompID AND OurID = :OurID AND Status = 1 ORDER BY EDate DESC, ChID ASC)) +&#13;&#10;(SELECT COUNT(*) FROM dbo.at_z_ContractsAdd zca WITH(NOLOCK) WHERE zca.HaveStamp = 1 AND zca.ChID = (SELECT TOP 1 ChID FROM dbo.at_z_Contracts WITH(NOLOCK) WHERE CompID = data.CompID AND OurID = :OurID AND Status = 1 ORDER BY EDate DESC, ChID ASC)) AS BIT) HaveStamp&#13;&#10;FROM (&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(TSumCC_wt*KursCC) BCSaldo, 0 BDSaldo, 0 ECSaldo, 0 EDSaldo FROM av_t_Rec m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(TSumCC_wt*KursCC), 0, 0 ECSaldo, 0 EDSaldo FROM av_t_Ret m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(TSumCC_wt*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_t_Inv m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(TSumCC_wt*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_t_Exp m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(TSumCC_wt*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_t_Epp m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(SumAC*KursCC), 0, 0 ECSaldo, 0 EDSaldo FROM av_t_MonRec m WHERE SumAC&#62;0 AND DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(-SumAC*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_t_MonRec m WHERE SumAC&#60;0 AND DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(SumAC*KursCC), 0, 0 ECSaldo, 0 EDSaldo FROM av_c_CompRec m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(SumAC*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_c_CompExp m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(SumAC*KursCC), 0, 0 ECSaldo, 0 EDSaldo FROM av_c_CompIn m WHERE SumAC&#62;0 AND DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(-SumAC*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_c_CompIn m WHERE SumAC&#60;0 AND DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, SUM(SumAC*KursCC), 0, 0 ECSaldo, 0 EDSaldo FROM av_c_CompCor m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, SUM(SumAC*KursCC), 0 ECSaldo, 0 EDSaldo FROM av_c_PlanRec m WHERE DocDate &#60; :BDate /* Filter */ GROUP BY m.CompID, m.OurID&#13;&#10;UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0 BCSaldo, 0 BDSaldo, SUM(TSumCC_wt*KursCC) ECSaldo, 0 EDSaldo FROM av_t_Rec m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, SUM(TSumCC_wt*KursCC) ECSaldo, 0 EDSaldo FROM av_t_Ret m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(TSumCC_wt*KursCC) EDSaldo FROM av_t_Inv m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(TSumCC_wt*KursCC) EDSaldo FROM av_t_Exp m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(TSumCC_wt*KursCC) EDSaldo FROM av_t_Epp m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, SUM(SumAC*KursCC) ECSaldo, 0 EDSaldo FROM av_t_MonRec m WHERE SumAC&#62;0 AND DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(-SumAC*KursCC) EDSaldo FROM av_t_MonRec m WHERE SumAC&#60;0 AND DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, SUM(SumAC*KursCC) ECSaldo, 0 EDSaldo FROM av_c_CompRec m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(SumAC*KursCC) EDSaldo FROM av_c_CompExp m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, SUM(SumAC*KursCC) ECSaldo, 0 EDSaldo FROM av_c_CompIn m WHERE SumAC&#62;0 AND DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(-SumAC*KursCC) EDSaldo FROM av_c_CompIn m WHERE SumAC&#60;0 AND DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, SUM(SumAC*KursCC) ECSaldo, 0 EDSaldo FROM av_c_CompCor m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID UNION ALL&#13;&#10;SELECT m.CompID FLDNAME1, (SELECT BCompCode FROM dbo.at_r_CompOurTerms WITH(NOLOCK) WHERE CompID = m.CompID AND OurID = m.OurID) FLDNAME2, 0, 0, 0 ECSaldo, SUM(SumAC*KursCC) EDSaldo FROM av_c_PlanRec m WHERE DocDate &#60;= :EDate /* Filter */ GROUP BY m.CompID, m.OurID&#13;&#10;) data&#13;&#10;LEFT JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID = data.CompID&#13;&#10;LEFT JOIN dbo.at_r_CompOurTerms rcot WITH(NOLOCK) ON rcot.CompID = rc.CompID AND rcot.OurID = :OurID&#13;&#10;LEFT JOIN dbo.at_r_SRs srs WITH(NOLOCK) ON srs.SRID = rcot.SRID AND 0 = :IsConsCode&#13;&#10;GROUP BY data.CompID, rc.Contract2, rc.Contract1, rc.Job3, srs.SRName" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667403A0000470546F7002100A506172616D657465727301010651204E616D653D224F75724944222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B64715F4F7572732E262333343B4F75724944262333343B262336323B2200010644204E616D653D224244617465222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22496E742863746C5F53746172742E44617465292200010642204E616D653D224544617465222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22496E742863746C5F456E642E44617465292200010664204E616D653D224973436F6E73436F6465222044617461547970653D226674426F6F6C65616E222045787072657373696F6E3D2263746C5F4973436F6E73436F64652E436865636B656420616E64207262436F6D7046696C7465722E436865636B6564220000"/>
    <TfrxBDEQuery Name="dq_Srs" UserName="dq_Srs" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT SRID, CAST(CAST(SRID AS VARCHAR(10)) + ' - ' + SRName AS VARCHAR(250)) AS SRName&#13;&#10;FROM at_r_SRS WITH(NOLOCK)&#13;&#10;ORDER BY 1" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667402240470546F7002100A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" ResetPageNumbers="True" HGuides.Text="" VGuides.Text="" OnManualBuild="Page1OnManualBuild">
    <TfrxFooter Name="bndf_Doc" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Height="22.67718" Left="0" ParentFont="False" Top="381.73253" Width="680.3154">
      <TfrxMemoView Name="Memo27" Left="0" Top="0" Width="264.5671" Height="22.67718" ShowHint="False" AllowExpressions="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="Разом обороти:"/>
      <TfrxMemoView Name="Memo28" Left="264.5671" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(Memo23.Value)]"/>
      <TfrxMemoView Name="Memo29" Left="370.39394" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(Memo24.Value)]"/>
      <TfrxMemoView Name="Memo30" Left="472.44125" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" AllowExpressions="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo31" Left="578.26809" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" AllowExpressions="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxFooter>
    <TfrxMasterData Name="bndm_Doc" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Height="158.74026" Left="0" ParentFont="False" Top="18.89765" Width="680.3154" ColumnWidth="0" ColumnGap="0" DataSet="dq_Doc" DataSetName="dq_Doc" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="11.33859" Width="680.3154" Height="56.69295" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Tahoma" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="А К Т № [IIF(cb_PrintNum.Checked, IIF(rbSRFilter.Checked, VarToStr(&#60;dq_Doc.&#34;CompID&#34;&#62;), ctl_Num.Text), '')]&#13;&#10;звірки взаєморозрахунків&#13;&#10;[ctl_end.Date #ddd] [ДатуВСтроку(ctl_End.Date,4,'wwww')] [ctl_end.Date #dyyyy] р."/>
      <TfrxMemoView Name="Memo4" Left="0" Top="68.03154" Width="680.3154" Height="90.70872" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Tahoma" Font.Style="0" GapY="10" HAlign="haBlock" ParagraphGap="15" ParentFont="False" Text="Ми, що підписалися нижче, представник [dq_Ours.&#34;RealName&#34;] в особі [IIF(cb_DirMode.Checked, 'директора ' + &#60;dq_Emps.&#34;EmpName&#34;&#62;, &#60;dq_Emps.&#34;EmpName&#34;&#62; + ', що діє на підставі довіреності №' + IntToStr(&#60;dq_Emps.&#34;AttorID&#34;&#62;) + ' від ' + FormatDateTime('dd.mm.yyyy',&#60;dq_Emps.&#34;AttorDate&#34;&#62;) + ' р.')], з одного боку, та представник [dq_Doc.&#34;CompName&#34;] в особі ________________________ здійснили звірку взаєморозрахунків станом на [ctl_End.Date #ddd.mm.yyyy] р."/>
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="124.72449" Height="11.33859" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Frame.Width="2" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;Job3&#34;]"/>
      <TfrxMemoView Name="Memo18" Left="124.72449" Top="0" Width="555.59091" Height="11.33859" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Frame.Width="2" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;CompID&#34;] / [CForm] [dq_Doc.&#34;EmpName&#34;]"/>
      <TfrxMemoView Name="Memo3" Printable="False" Left="0" Top="11.33859" Width="124.72449" Height="56.69295" ShowHint="False" Font.Charset="1" Font.Color="8421504" Font.Height="-48" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[CopyNum]"/>
    </TfrxMasterData>
    <TfrxChild Name="Child1" Height="68.03154" Left="0" Top="200.31509" Width="680.3154" OnAfterCalcHeight="Child1OnAfterCalcHeight" Stretched="True">
      <TfrxMemoView Name="Memo5" ShiftMode="smWhenOverlapped" Left="0" Top="0" Width="64.25201" Height="68.03154" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="64.25201" Top="0" Width="60.47248" Height="68.03154" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№&#13;&#10;доку-&#13;&#10;менту"/>
      <TfrxMemoView Name="Memo7" ShiftMode="smWhenOverlapped" Left="124.72449" Top="0" Width="139.84261" Height="68.03154" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Операція"/>
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="264.5671" Top="0" Width="207.87415" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="За даними"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="472.44125" Top="0" Width="207.87415" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="За даними"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="264.5671" Top="18.8976500000001" Width="207.87415" Height="30.23624" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[dq_Ours.&#34;RealName&#34;]"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="472.44125" Top="18.8976500000001" Width="207.87415" Height="30.23624" ShowHint="False" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;CompName&#34;]"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="264.5671" Top="49.1338899999997" Width="105.82684" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дебет"/>
      <TfrxMemoView Name="Memo13" ShiftMode="smWhenOverlapped" Left="370.39394" Top="49.1338899999997" Width="102.04731" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Кредит"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="472.44125" Top="49.1338899999997" Width="105.82684" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дебет"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smWhenOverlapped" Left="578.26809" Top="49.1338899999997" Width="102.04731" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Кредит"/>
    </TfrxChild>
    <TfrxChild Name="Child2" Height="22.67718" Left="0" Top="291.02381" Width="680.3154">
      <TfrxMemoView Name="Memo45" ShiftMode="smWhenOverlapped" Left="0" Top="0" Width="264.5671" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="11" GapX="4" ParentFont="False" VAlign="vaCenter" Text="Сальдо на [ctl_start.Date #ddd.mm.yyyy]:"/>
      <TfrxMemoView Name="Memo46" ShiftMode="smWhenOverlapped" Left="264.5671" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="11" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;BDSaldo&#34;]"/>
      <TfrxMemoView Name="Memo47" ShiftMode="smWhenOverlapped" Left="370.39394" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="11" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;BCSaldo&#34;]"/>
      <TfrxMemoView Name="Memo48" ShiftMode="smWhenOverlapped" Left="472.44125" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="11" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo49" ShiftMode="smWhenOverlapped" Left="578.26809" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="11" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxChild>
    <TfrxDetailData Name="bndd_Doc" Height="22.67718" Left="0" Top="336.37817" Width="680.3154" ColumnWidth="0" ColumnGap="0" DataSet="dq_DocD" DataSetName="dq_DocD" KeepFooter="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo16" Left="0" Top="0" Width="64.25201" Height="22.67718" ShowHint="False" DataSetName="dq_Period" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[dq_DocD.&#34;DocDate&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="64.25201" Top="0" Width="60.47248" Height="22.67718" ShowHint="False" DataSetName="dq_Period" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[dq_DocD.&#34;TaxDocID&#34;]"/>
      <TfrxMemoView Name="Memo22" Left="124.72449" Top="0" Width="139.84261" Height="22.67718" ShowHint="False" DataSetName="dq_Period" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" ParentFont="False" VAlign="vaCenter" Text="[dq_DocD.&#34;DocName&#34;]"/>
      <TfrxMemoView Name="Memo23" Left="264.5671" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DataSetName="dq_Period" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[dq_DocD.&#34;DSumCC&#34;]"/>
      <TfrxMemoView Name="Memo24" Left="370.39394" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DataSetName="dq_Period" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[dq_DocD.&#34;CSumCC&#34;]"/>
      <TfrxMemoView Name="Memo25" Left="472.44125" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" AllowExpressions="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo26" Left="578.26809" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" AllowExpressions="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="15" Frame.Width="0.5" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxLineView Name="Line1" Left="472.44125" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
      <TfrxLineView Name="Line2" Left="264.5671" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
      <TfrxLineView Name="Line3" Left="124.72449" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
      <TfrxLineView Name="Line4" Left="64.25201" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
      <TfrxLineView Name="Line5" Left="680.3154" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
      <TfrxLineView Name="Line6" Left="0" Top="0" Width="0" Height="22.67718" ShowHint="False" Frame.Typ="1"/>
    </TfrxDetailData>
    <TfrxChild Name="Child4" Height="181.41744" Left="0" Top="472.44125" Width="680.3154">
      <TfrxMemoView Name="Memo37" Left="0" Top="11.3385899999999" Width="680.3154" Height="34.01577" ShowHint="False" StretchMode="smActualHeight" AllowHTMLTags="True" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" HAlign="haCenter" LineSpacing="4" ParentFont="False" Text="Після звірки взаєморозрахунків залишок на [ctl_End.Date #ddd.mm.yyyy] складає:&#13;&#10;&#60;b&#62;[SumToText(ОкруглитьДо(&#60;dq_Doc.&#34;EDSaldo&#34;&#62; + &#60;dq_Doc.&#34;ECSaldo&#34;&#62;,2),1,'0')]&#60;/b&#62;"/>
      <TfrxMemoView Name="Memo39" Left="0" Top="56.69295" Width="680.3154" Height="30.23624" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="8" Frame.Width="0.5" HAlign="haBlock" ParentFont="False" Text="У разі не отримання на протязі 5-ти днів письмового підтвердження вищезазначених данних, ми вважатимемо наші дані достовірними."/>
      <TfrxMemoView Name="Memo40" Left="0" Top="109.60637" Width="309.92146" Height="52.91342" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="8" Frame.Width="0.5" ParentFont="False" Text="Представник [dq_Ours.&#34;RealName&#34;]"/>
      <TfrxMemoView Name="Memo41" Left="0" Top="162.51979" Width="309.92146" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Width="0.5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="МП"/>
      <TfrxMemoView Name="Memo42" Left="370.39394" Top="109.60637" Width="309.92146" Height="52.91342" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Typ="8" Frame.Width="0.5" ParentFont="False" Text="Представник [dq_Doc.&#34;CompName&#34;]"/>
      <TfrxMemoView Name="Memo43" Left="370.39394" Top="162.51979" Width="309.92146" Height="18.89765" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Frame.Width="0.5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(&#60;dq_Doc.&#34;HaveStamp&#34;&#62;, 'Місце для печатки', 'БП')]"/>
    </TfrxChild>
    <TfrxChild Name="Child3" Height="22.67718" Left="0" Top="427.08689" Width="680.3154">
      <TfrxMemoView Name="Memo32" Left="0" Top="0" Width="264.5671" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="Сальдо на [ctl_end.Date #ddd.mm.yyyy]:"/>
      <TfrxMemoView Name="Memo33" Left="264.5671" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;EDSaldo&#34;]"/>
      <TfrxMemoView Name="Memo34" Left="370.39394" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[dq_Doc.&#34;ECSaldo&#34;]"/>
      <TfrxMemoView Name="Memo35" Left="472.44125" Top="0" Width="105.82684" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo36" Left="578.26809" Top="0" Width="102.04731" Height="22.67718" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxChild>
  </TfrxReportPage>
  <TfrxDialogPage Name="dlg_Filter" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Параметры" Height="619" ClientHeight="580" Left="367" Top="187" Width="799" ClientWidth="783" OnKeyPress="dlg_FilterOnKeyPress" OnShow="dlg_FilterOnShow">
    <TfrxGroupBoxControl Name="gbMainFilter" Left="4" Top="4" Width="336" Height="100" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="  Основной фильтр  " Color="-16777201">
      <TfrxRadioButtonControl Name="rbCompFilter" Left="8" Top="20" Width="113" Height="17" ShowHint="True" Caption="Предприятие" TabStop="False" Color="-16777201" OnClick="rbCompFilterOnClick"/>
      <TfrxRadioButtonControl Name="rbSRFilter" Left="172" Top="20" Width="153" Height="17" ShowHint="True" Caption="Торговый представитель" TabStop="False" Color="-16777201" OnClick="rbSRFilterOnClick"/>
    </TfrxGroupBoxControl>
    <TfrxLabelControl Name="Label1" Left="8" Top="388" Width="100" Height="13" ShowHint="True" Caption="Номер акта сверки:" Color="-16777201"/>
    <TfrxEditControl Name="ctl_Num" Left="8" Top="404" Width="304" Height="20" Enabled="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxGroupBoxControl Name="GroupBox1" Left="4" Top="112" Width="336" Height="100" ShowHint="True" Caption="  Период  " Color="-16777201">
      <TfrxDateEditControl Name="ctl_Start" Left="6" Top="36" Width="152" Height="20" ShowHint="True" Color="-16777211" Date="39814.0394149653" Time="39814.0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label2" Left="6" Top="18" Width="100" Height="15" ShowHint="True" AutoSize="False" Caption="Начальная дата:" Color="-16777201"/>
      <TfrxDateEditControl Name="ctl_End" Left="172" Top="36" Width="152" Height="20" ShowHint="True" Color="-16777211" Date="39845.0394149653" Time="39845.0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label4" Left="172" Top="18" Width="100" Height="15" ShowHint="True" AutoSize="False" Caption="Конечная дата:" Color="-16777201"/>
      <TfrxButtonControl Name="ctl_Period" Left="232" Top="66" Width="91" Height="25" ShowHint="True" Caption="Выбор периода" OnClick="ctl_PeriodOnClick"/>
    </TfrxGroupBoxControl>
    <TfrxLabelControl Name="Label6" Left="8" Top="216" Width="100" Height="16" ShowHint="True" AutoSize="False" Caption="Фирма:" Color="-16777201"/>
    <TfrxEditControl Name="Codes1" Left="8" Top="272" Width="304" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxEditControl Name="Codes2" Left="8" Top="312" Width="304" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxEditControl Name="Codes3" Left="8" Top="352" Width="304" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label7" Left="8" Top="296" Width="100" Height="16" ShowHint="True" AutoSize="False" Caption="Признаки 2:" Color="-16777201"/>
    <TfrxButtonControl Name="ctl_Ok" Left="348" Top="8" Width="76" Height="24" ShowHint="True" Caption="OK" Default="True" ModalResult="1" OnClick="ctl_OkOnClick"/>
    <TfrxButtonControl Name="Button2" Left="348" Top="40" Width="76" Height="24" ShowHint="True" Cancel="True" Caption="Отмена" ModalResult="2"/>
    <TfrxLabelControl Name="Label8" Left="8" Top="336" Width="100" Height="16" ShowHint="True" AutoSize="False" Caption="Признаки 3:" Color="-16777201"/>
    <TfrxLabelControl Name="Label11" Left="8" Top="256" Width="100" Height="16" ShowHint="True" AutoSize="False" Caption="Признаки 1:" Color="-16777201"/>
    <TfrxBevelControl Name="Bevel1" Left="4" Top="380" Width="340" Height="2" ShowHint="True"/>
    <TfrxLabelControl Name="Label5" Left="8" Top="452" Width="120" Height="13" ShowHint="True" Caption="Представитель фирмы:" Color="-16777201"/>
    <TfrxDBLookupComboBox Name="ctl_Dir" Left="8" Top="468" Width="304" Height="20" Hint="Выбор имени представиителя фирмы" ShowHint="True" AutoOpenDataSet="True" DataSet="dq_Emps" DataSetName="dq_Emps" ListField="EmpName" KeyField="EmpID" DropDownWidth="0" DropDownRows="7"/>
    <TfrxCheckBoxControl Name="ctl_IsGroupData" Left="12" Top="516" Width="296" Height="16" Hint="Группирует данные по номеру налоговой, а не по номеру документа из &#34;Бизнеса&#34;" ShowHint="True" Caption="Группировка данных по номеру налоговой" Color="-16777201"/>
    <TfrxCheckBoxControl Name="ctlSegmPrint" Left="12" Top="536" Width="296" Height="16" Hint="Включает или отключает печать типа сегмента для предприятия" ShowHint="True" Caption="Печать сегмента" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cb_PrintNum" Left="12" Top="428" Width="173" Height="17" Hint="Включает или отключает печать номера акта сверки" ShowHint="True" Caption="Печать номера акта сверки" Color="-16777201" OnClick="cb_PrintNumOnClick"/>
    <TfrxCheckBoxControl Name="cb_DirMode" Left="12" Top="492" Width="296" Height="16" Hint="Если опция выбрана, представитель - директор, иначе представитель - доверенное лицо" ShowHint="True" Caption="Представитель фирмы: директор/доверенное лицо" Color="-16777201" OnClick="cb_DirModeOnClick"/>
    <TfrxSpeedButtonControl Name="CodeID1" Left="320" Top="272" Width="24" Height="20" GroupIndex="0" ShowHint="True" Caption="..." OnClick="CodeID1OnClick"/>
    <TfrxSpeedButtonControl Name="CodeID2" Left="320" Top="312" Width="24" Height="20" GroupIndex="0" ShowHint="True" Caption="..." OnClick="CodeID2OnClick"/>
    <TfrxSpeedButtonControl Name="CodeID3" Left="320" Top="352" Width="24" Height="20" GroupIndex="0" ShowHint="True" Caption="..." OnClick="CodeID3OnClick"/>
    <TfrxDBLookupComboBox Name="cbOurs" Left="8" Top="232" Width="304" Height="20" ShowHint="True" DataSet="dq_Ours" DataSetName="dq_Ours" ListField="OurName" KeyField="OurID" DropDownWidth="0" DropDownRows="7" OnClick="RefreshEmps" OnExit="RefreshEmps"/>
    <TfrxPanelControl Name="pCompFilter" Left="452" Top="44" Width="321" Height="53" ShowHint="True" Alignment="taLeftJustify" BevelOuter="bvNone" Color="-16777201">
      <TfrxEditControl Name="Comps" Left="4" Top="4" Width="44" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="0" OnChange="CompsOnChange" OnEnter="CompsOnEnter" OnExit="CompsOnExit" OnKeyPress="CompsOnKeyPress"/>
      <TfrxEditControl Name="CompName" Left="52" Top="4" Width="240" Height="20" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
      <TfrxCheckBoxControl Name="ctl_IsConsCode" Left="6" Top="33" Width="301" Height="17" Hint="Если не знаешь, что это - НЕ НАЖИМАЙ!" ShowHint="True" Caption="Код является консолидированным" Color="-16777201" OnClick="ctl_IsConsCodeOnClick"/>
      <TfrxSpeedButtonControl Name="CompID" Left="296" Top="4" Width="24" Height="20" GroupIndex="0" ShowHint="True" Caption="..." OnClick="CompIDOnClick"/>
    </TfrxPanelControl>
    <TfrxPanelControl Name="pSRFilter" Left="436" Top="44" Width="321" Height="53" ShowHint="True" Alignment="taLeftJustify" BevelOuter="bvNone" Color="-16777201">
      <TfrxDBLookupComboBox Name="cbSRs" Left="4" Top="4" Width="313" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="dq_Srs" DataSetName="dq_Srs" ListField="SRName" KeyField="SRID" DropDownWidth="0" DropDownRows="7"/>
      <TfrxCheckBoxControl Name="cbWithDataOnly" Left="4" Top="32" Width="309" Height="17" ShowHint="True" Caption="Активные предприятия (сальдо+движение)" Color="-16777201"/>
    </TfrxPanelControl>
    <TfrxLabelControl Name="Label3" Left="12" Top="564" Width="97" Height="13" ShowHint="True" Caption="Количество копий:" Color="-16777201"/>
    <TfrxComboBoxControl Name="cbCopyCnt" Left="116" Top="560" Width="76" Height="20" ShowHint="True" Color="-16777211" Items.Text="1&#13;&#10;2&#13;&#10;3&#13;&#10;4" Style="csDropDownList" Text="2" ItemIndex="1"/>
    <TfrxBevelControl Name="Bevel2" Left="4" Top="556" Width="340" Height="2" ShowHint="True"/>
  </TfrxDialogPage>
</TfrxReport>
