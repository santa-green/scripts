<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.12" DotMatrixReport="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40729,6652206829" ReportOptions.Description.Text="" ReportOptions.LastChange="42444,5982806597" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  RegPath: string = 'Бизнес\Инструменты\Экспорт MeDoc';&#13;&#10;  PathDelim: Char = '\';&#13;&#10;  // Сюда пишем окончание номера текущей редакции налоговой&#13;&#10;  FormSuffix: string = '07';        &#13;&#10;&#13;&#10;&#13;&#10;function ExportXml(DS: TDataset): string;&#13;&#10;var&#13;&#10;  i: Integer;                     &#13;&#10;begin&#13;&#10;//  InputQuery('','',tfrxbdequery(ds).sql.text);    &#13;&#10;  if not DS.Active then DS.Open;&#13;&#10;  DS.First;&#13;&#10;  i := 0;                    &#13;&#10;  while not DS.EOF do&#13;&#10;  begin&#13;&#10;    if dq_Run.Active then dq_Run.Close;&#13;&#10;    if DS.FieldByName('DocType').Value = 0 then&#13;&#10;      dq_Run.SQL.Text := 'EXEC [dbo].[ap_Export_J12010' + FormSuffix + '] @ChID = ' + DS.FieldByName('ChID').AsString + ', @DocCode = ' + DS.FieldByName('DocCode').AsString + ', @IsConsolidated = ' + BoolToStr(cbConsolidated.Checked)                                                &#13;&#10;    else                &#13;&#10;      dq_Run.SQL.Text := 'EXEC [dbo].[ap_Export_J12012' + FormSuffix + '] @ChID = ' + DS.FieldByName('ChID').AsString + ', @DocCode = ' + DS.FieldByName('DocCode').AsString;&#13;&#10;                   &#13;&#10;    if (cbConsolidated.Checked and (i = 0)) or not cbConsolidated.Checked then&#13;&#10;    begin&#13;&#10;      //dq_Run.Params[0].Value := DS.Fields[0].Value;&#13;&#10;      dq_Run.Open;&#13;&#10;      while not dq_Run.EOF do&#13;&#10;      begin&#13;&#10;        Result := Result + dq_Run.Fields[0].AsString;&#13;&#10;        dq_Run.Next;&#13;&#10;      end;&#13;&#10;      dq_Run.Close;&#13;&#10;      Inc(i);&#13;&#10;    end;&#13;&#10;    DS.Next;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure ctl_OkOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  AFilter, AFileName, OursStr, OurID, TmpStr: string;&#13;&#10;  i: Integer;&#13;&#10;begin&#13;&#10;  Реестр_Записать('IsConsCode', BoolToStr(ctl_IsConsCode.Checked), RegPath);&#13;&#10;  Реестр_Записать('BDate', DateToStr(Ctl_Start.Date), RegPath);&#13;&#10;  Реестр_Записать('EDate', DateToStr(Ctl_End.Date), RegPath);&#13;&#10;  Реестр_Записать('cbStates', VarToStr(cbStates.KeyValue), RegPath);&#13;&#10;&#13;&#10;  { Формирование строки фильтра }&#13;&#10;  AFilter := 'm.TaxDocDate BETWEEN ''' + FormatDateTime('yyyymmdd', ctl_Start.Date) + ''' AND ''' + FormatDateTime('yyyymmdd', ctl_End.Date) + ''''#13 +&#13;&#10;    ' AND m.OurID = ' + dq_Ours.Fields[0].AsString + #13 +&#13;&#10;    IIF(Trim(Codes1.Text) = '', '', 'AND (' + СписокВУсловиеSQL('m.CodeID1', IIF(rbPlanRec.Checked, '80', Codes1.Text)) + ')') + #13 +&#13;&#10;    IIF(Trim(Codes2.Text) = '', '', 'AND (' + СписокВУсловиеSQL('m.CodeID2', IIF(rbPlanRec.Checked, '93', Codes2.Text)) + ')') + #13 +&#13;&#10;    IIF(Trim(Codes3.Text) = '', '', 'AND (' + СписокВУсловиеSQL('m.CodeID3', Codes3.Text) + ')') + #13 +&#13;&#10;    IIF(Trim(cbStates.Text) = '', '', 'AND m.StateCode = ' + VarToStr(cbStates.KeyValue)) + #13 +&#13;&#10;    IIF(TRIM(edtCompID.Text) = '0', '', 'AND (' + СписокВУсловиеSQL(IIF(ctl_IsConsCode.Checked, 'rc.Value1', 'm.CompID'), edtCompID.Text) + ')') + #13 +&#13;&#10;    IIF(TRIM(edtTaxDocID.Text) = '', '', 'AND m.TaxDocID IN (' + edtTaxDocID.Text + ')');&#13;&#10;&#13;&#10;  if rbPlanRec.Checked then                               &#13;&#10;    AFilter := ReplaceStr(ReplaceStr(AFilter, 'm.OurID', 'm.OurID - 20'), 'm.Tax', 'm.');                                                                     &#13;&#10;&#13;&#10;  if cbConsolidated.Checked and ctl_IsConsCode.Checked and rbInv.Checked then&#13;&#10;  begin&#13;&#10;    if MessageDlg(Format('Далее будет сформирован файл экспорта консолидированной накладной №%s для всех документов ' +&#13;&#10;    'данного КОНСОЛИДИРОВАННОГО кода предприятия %s за %s г!',&#13;&#10;[edtTaxDocID.Text, edtCompID.Text,&#13;&#10;     FormatDateTime('mmmm yyyy',&#13;&#10;       IIF(rbInv.Checked,&#13;&#10;         БДПоиск('TOP 1 DocDate','dbo.t_Inv m WITH(NOLOCK)','m.TaxDocID=''' + edtTaxDocID.Text + ''' AND (m.OurID=' + dq_Ours.Fields[0].AsString +') OPTION(FAST 1)'),&#13;&#10;         БДПоиск('MAX(DocDate)','dbo.t_Ret m WITH(NOLOCK) JOIN dbo.t_RetD d WITH(NOLOCK) ON d.ChID = m.ChID','d.TaxDocID=' + edtTaxDocID.Text + ' AND (m.OurID=' + dq_Ours.Fields[0].AsString + ')')&#13;&#10;          )&#13;&#10;                   )]),mtInformation,mbYes+mbNo,0) = mrNo then Exit;&#13;&#10;  end;&#13;&#10;&#13;&#10;  { Запросы для итоговой таблицы @дата налоговой@номер налоговой внешний@сумма@код предприятия@имя предприятия@}&#13;&#10; if rbInv.Checked then&#13;&#10;    dq_Main.SQL.Text := 'SELECT DISTINCT m.ChID, m.OurID, m.CodeID2, m.TaxDocDate, m.TaxDocID,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumCC_wt),2) FROM dbo.t_InvD WHERE ChID = m.CHID) SumCC_wt,'#13 +&#13;&#10;      'CASE m.CodeID2 WHEN 58 THEN'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumCC_wt),2) FROM dbo.t_InvD WHERE ChID = m.CHID) ELSE ' +&#13;&#10;      '(SELECT ROUND(SUM(SumCC_nt),2) FROM dbo.t_InvD WHERE ChID = m.CHID) END SumCC_nt,'#13 +&#13;&#10;      'CASE m.CodeID2 WHEN 58 THEN 0 ELSE '#13 +&#13;&#10;      '(SELECT ROUND(SUM(TaxSum),2) FROM dbo.t_InvD WHERE ChID = m.CHID) END TaxSum,'#13 +&#13;&#10;      'm.CompID, rc.Contract1, 0 DocType, 11012 DocCode'#13 +&#13;&#10;      'FROM dbo.t_Inv m WITH(NOLOCK)'#13 +&#13;&#10;      'JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID=m.CompID'#13 +&#13;&#10;      'WHERE (' + AFilter + ') AND TaxDocID != 0 AND m.CodeID2 NOT IN(43,44,38)'#13 +&#13;&#10;      'ORDER BY 2,3,4'&#13;&#10;  else if rbRet.Checked then&#13;&#10;    dq_Main.SQL.Text :=&#13;&#10;      'SELECT m.ChID, m.OurID, m.CodeID2, m.TaxDocDate, m.TaxDocID,'#13 +&#13;&#10;      '(SUM(ISNULL(id.Qty, 0)*ISNULL(id.PriceCC_nt, 0)) - SUM(rtd.Qty*rtd.PriceCC_nt))*1.2 SumCC_wt,'#13 +&#13;&#10;      '(SUM(ISNULL(id.Qty, 0)*ISNULL(id.PriceCC_nt, 0)) - SUM(rtd.Qty*rtd.PriceCC_nt)) SumCC_nt,'#13 +&#13;&#10;      '(SUM(ISNULL(id.Qty, 0)*ISNULL(id.PriceCC_nt, 0)) - SUM(rtd.Qty*rtd.PriceCC_nt))/5 TaxSum,'#13 +&#13;&#10;      'm.CompID, rc.Contract1, 1 DocType, 11003 DocCode'#13 +&#13;&#10;      'FROM dbo.t_Ret m WITH(NOLOCK)'#13 +&#13;&#10;      'JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID=m.CompID'#13 +&#13;&#10;      'JOIN (SELECT ChID, ProdID, PPID, PriceCC_nt, SUM(Qty) Qty FROM dbo.t_RetD WITH(NOLOCK) GROUP BY ChID, ProdID, PPID, PriceCC_nt) rtd ON rtd.ChID = m.ChID'#13 +&#13;&#10;      'LEFT JOIN dbo.t_Inv im WITH(NOLOCK) ON im.TaxDocID = m.TaxDocID AND im.OurID = m.OurID AND im.StockID = m.StockID AND im.CodeID2 = m.CodeID2 AND im.DocDate=m.DocDate AND m.CodeID2 IN (43,44,38)'#13 +&#13;&#10;      'LEFT JOIN (SELECT ChID, ProdID, PPID, PriceCC_nt, SUM(Qty) Qty FROM dbo.t_InvD WITH(NOLOCK) GROUP BY ChID, ProdID, PPID, PriceCC_nt) id ON id.ChID = im.ChID AND id.ProdID = rtd.ProdID AND id.PPID = rtd.PPID'#13 +&#13;&#10;      'JOIN dbo.r_Prods rp WITH(NOLOCK) ON rp.ProdID = rtd.ProdID'#13 +&#13;&#10;      'JOIN dbo.t_PInP pp WITH(NOLOCK) ON pp.ProdID = rtd.ProdID AND pp.PPID = rtd.PPID'#13 +&#13;&#10;      'LEFT JOIN dbo.r_ProdEC ec WITH(NOLOCK) ON ec.ProdID = m.CompID AND ec.ProdID = rp.ProdID'#13 +&#13;&#10;      'WHERE (' + AFilter + ') AND m.TaxDocID != 0'#13 +&#13;&#10;      'AND'#13 +&#13;&#10;      '((m.CodeID2 IN (43,38) AND rtd.PriceCC_nt &#60;&#62; ISNULL(id.PriceCC_nt,0)) OR'#13 +&#13;&#10;      '(m.CodeID2 NOT IN (43,38) AND rtd.Qty &#60;&#62; ISNULL(id.Qty,0)))'#13 +&#13;&#10;      'GROUP BY m.ChID, m.OurID, m.CodeID2, m.TaxDocDate, m.TaxDocID,'#13 +&#13;&#10;      'm.CompID, rc.Contract1'#13 +&#13;&#10;      'ORDER BY 2,3,4'&#13;&#10;  else if rbPrepay.Checked then&#13;&#10;    dq_Main.SQL.Text := 'SELECT DISTINCT m.ChID, m.OurID, m.CodeID2, m.TaxDocDate, m.TaxDocID,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumCC_wt),2) FROM dbo.at_t_PrepayD WITH(NOLOCK) WHERE ChID = m.CHID) SumCC_wt,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumCC_nt),2) FROM dbo.at_t_PrepayD WITH(NOLOCK) WHERE ChID = m.CHID) SumCC_nt,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(TaxSum),2) FROM dbo.at_t_PrepayD WITH(NOLOCK) WHERE ChID = m.CHID) TaxSum,'#13 +&#13;&#10;      'm.CompID, rc.Contract1, CASE m.CodeID2 WHEN 88 THEN 0 WHEN 89 THEN 1 END DocType, 666027 DocCode'#13 +&#13;&#10;      'FROM dbo.at_t_Prepay m WITH(NOLOCK)'#13 +&#13;&#10;      'JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID=m.CompID'#13 +&#13;&#10;      'WHERE (' + AFilter + ') AND TaxDocID != 0 AND m.CodeID2 IN(88,89)'#13 +&#13;&#10;      'ORDER BY 2,3,4'&#13;&#10;  else if rbPlanRec.Checked then&#13;&#10;    dq_Main.SQL.Text := 'SELECT DISTINCT m.AChID AS ChID, m.OurID, m.CodeID2, m.DocDate TaxDocDate, m.DocID TaxDocID,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumAC * KursCC), 2) FROM dbo.av_c_PlanRec WITH(NOLOCK) WHERE AChID = m.AChID) SumCC_wt,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumAC * KursCC)/1.2, 2) FROM dbo.av_c_PlanRec WITH(NOLOCK) WHERE AChID = m.AChID) SumCC_nt,'#13 +&#13;&#10;      '(SELECT ROUND(SUM(SumAC * KursCC)/6, 2) FROM dbo.av_c_PlanRec WITH(NOLOCK) WHERE AChID = m.AChID) TaxSum,'#13 +&#13;&#10;      'm.CompID, rc.Contract1, 0 AS DocType, 12022 DocCode'#13 +&#13;&#10;      'FROM dbo.av_c_PlanRec m WITH(NOLOCK)'#13 +&#13;&#10;      'JOIN dbo.r_Comps rc WITH(NOLOCK) ON rc.CompID=m.CompID'#13 +&#13;&#10;      'WHERE (' + AFilter + ') AND m.CodeID1 = 80 AND m.DocDate &#62; ''20140228'''#13 +&#13;&#10;      'ORDER BY 2,3,4';&#13;&#10;&#13;&#10;  dq_Main.Open;&#13;&#10;{  dlg_Filter.ModalResult := mrOk;&#13;&#10;  Exit;}                                   &#13;&#10;  if not dq_Main.IsEmpty then&#13;&#10;  begin&#13;&#10;  { Подготовка запросов источников данных }&#13;&#10;    WaitShow;&#13;&#10;    &#13;&#10;    TmpStr := ExportXml(dq_Main.DataSet);&#13;&#10;&#13;&#10;    AFileName := IncludeTrailingPathDelimiter(edtExportPath.Text) + 'Фирма_' + dq_Ours.Fields[0].AsString + FormatDateTime('_yyyy-mm-dd-hh-nn-ss_', Now) +&#13;&#10;      БДПоиск('SUBSTRING(CAST(NEWID() AS VARCHAR(100)),1,8)', '', '') + '.XML';&#13;&#10;&#13;&#10;    with TStringList.Create() do&#13;&#10;    try&#13;&#10;      if Trunc(ctl_End.Date) &#60; EncodeDate(2014,03,01) then&#13;&#10;        Text := '&#60;?xml version=&#34;1.0&#34; encoding=&#34;windows-1251&#34;?&#62;'#13#10 +&#13;&#10;          '&#60;ZVIT&#62;&#60;TRANSPORT&#62;&#60;CREATEDATE&#62;' + DateToStr(Now) + '&#60;/CREATEDATE&#62;&#60;VERSION&#62;3.0&#60;/VERSION&#62;&#60;/TRANSPORT&#62;&#60;ORG&#62;&#60;FIELDS&#62;&#60;EDRPOU&#62;' + dq_Ours.FieldByName('Code').AsString + '&#60;/EDRPOU&#62;&#60;/FIELDS&#62;' +&#13;&#10;          TmpStr + #13#10'&#60;/ORG&#62;&#60;/ZVIT&#62;'&#13;&#10;      else&#13;&#10;        Text := '&#60;?xml version=&#34;1.0&#34; encoding=&#34;windows-1251&#34;?&#62;'#13#10 +&#13;&#10;          '&#60;ZVIT&#62;&#60;TRANSPORT&#62;&#60;CREATEDATE&#62;' + DateToStr(Now) + '&#60;/CREATEDATE&#62;&#60;VERSION&#62;4.0&#60;/VERSION&#62;&#60;/TRANSPORT&#62;&#60;ORG&#62;&#60;FIELDS&#62;&#60;EDRPOU&#62;' + dq_Ours.FieldByName('Code').AsString + '&#60;/EDRPOU&#62;&#60;/FIELDS&#62;' +&#13;&#10;          TmpStr + #13#10'&#60;/ORG&#62;&#60;/ZVIT&#62;';&#13;&#10;      SaveToFile(AFileName);&#13;&#10;    finally&#13;&#10;      Free;&#13;&#10;    end;&#13;&#10;        &#13;&#10;    SetLength(TmpStr, 0);&#13;&#10;    WaitHide;&#13;&#10;    dq_Main.Filtered := False;&#13;&#10;    MessageDlg('Экспорт выполнен успешно.'#13#13'Результат сохранён в файл(ы):' + AFileName, mtInformation, mbOk, 0);&#13;&#10;    if rbInv.Checked then&#13;&#10;      ВыполнитьSQLЗапрос('UPDATE m SET m.StateCode = 191 FROM dbo.t_Inv m JOIN r_Comps rc ON rc.CompID = m.CompID WHERE (' + AFilter + ') AND m.TaxDocID != 0 AND m.StateCode = 190 AND m.CodeID2 NOT IN(43,44,38)')&#13;&#10;    else if rbRet.Checked then&#13;&#10;      ВыполнитьSQLЗапрос('SET XACT_ABORT ON BEGIN TRAN'#13 +&#13;&#10;      'UPDATE d SET d.StateCode = 191 FROM dbo.t_Ret m JOIN dbo.t_Inv d ON d.TaxDocID = m.TaxDocID AND d.OurID = m.OurID AND d.StockID = m.StockID AND d.CodeID2 = m.CodeID2'#13 +&#13;&#10;      'JOIN r_Comps rc ON rc.CompID = m.CompID'#13 +&#13;&#10;      'WHERE d.StateCode = 190 AND (' + AFilter + ') AND m.TaxDocID != 0'#13 +&#13;&#10;      'UPDATE m SET m.StateCode = 191 FROM dbo.t_Ret m JOIN r_Comps rc ON rc.CompID = m.CompID WHERE (' + AFilter + ') AND m.TaxDocID != 0'#13 +&#13;&#10;      'IF @@TRANCOUNT &#62; 0 COMMIT SET XACT_ABORT OFF')&#13;&#10;    else if rbPrepay.Checked then&#13;&#10;      ВыполнитьSQLЗапрос('UPDATE m SET m.StateCode = 191 FROM dbo.at_t_Prepay m JOIN r_Comps rc ON rc.CompID = m.CompID WHERE (' + AFilter + ') AND m.TaxDocID != 0 AND m.StateCode = 190 AND m.CodeID2 IN(88,89)')&#13;&#10;    else if rbPlanRec.Checked then&#13;&#10;      ВыполнитьSQLЗапрос('UPDATE m SET m.StateCode = 191 FROM dbo.c_PlanRec m JOIN r_Comps rc ON rc.CompID = m.CompID WHERE (' + AFilter + ') AND m.DocDate &#62; ''20140228'' AND m.StateCode != 191');          &#13;&#10;    dlg_Filter.ModalResult := mrOk;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    MessageDlg('Невозможно произвести экcпорт, так как для данного значения фильтра данные не обнаружены.', mtError, mbOk, 0);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure dlg_FilterOnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Ctl_Start.Date := StrToDate(Реестр_Прочитать('BDate', '01.01.' + IntToStr(YearOf(Now)), RegPath));&#13;&#10;  Ctl_End.Date := StrToDate(Реестр_Прочитать('EDate', '31.12.' + IntToStr(YearOf(Now)), RegPath));&#13;&#10;  dq_Ours.Params[0].Value := VarToStr(БДПоиск('Notes', 'r_Uni', 'RefTypeID=6660139 AND RefID=1'));&#13;&#10;  Codes1.Text := VarToStr(БДПоиск('Notes', 'r_Uni', 'RefTypeID=6660139 AND RefID=2'));&#13;&#10;  Codes2.Text := VarToStr(БДПоиск('Notes', 'r_Uni', 'RefTypeID=6660139 AND RefID=3'));&#13;&#10;  Codes3.Text := VarToStr(БДПоиск('Notes', 'r_Uni', 'RefTypeID=6660139 AND RefID=4'));&#13;&#10;  ctl_IsConsCode.Checked := StrToBool(Реестр_Прочитать('IsConsCode', '0', RegPath));&#13;&#10;  edtExportPath.Text := ExtractFilePath(Реестр_Прочитать('MRU', Реестр_Прочитать('Personal', 'C:\',&#13;&#10;    '\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders'), RegPath));&#13;&#10;  CompsOnChange(Sender);&#13;&#10;  dq_States.Open;&#13;&#10;  cbStates.KeyValue := Реестр_Прочитать('cbStates', '190', RegPath);&#13;&#10;  dq_Ours.Open;&#13;&#10;  cbOurs.KeyValue := БДФункция('zf_GetOurID', 't');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompsOnChange(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  CName: Variant;&#13;&#10;begin&#13;&#10;  CName := null;&#13;&#10;  if edtCompID.Text &#60;&#62; '' then&#13;&#10;  try&#13;&#10;    CName := БДПоиск('MIN(CompName)', 'dbo.r_Comps', IIF(ctl_IsConsCode.Checked, 'Value1 = ', 'CompID = ') + edtCompID.Text);&#13;&#10;  except&#13;&#10;  end;&#13;&#10;&#13;&#10;  if CName = null then&#13;&#10;  begin&#13;&#10;    CName := '&#60;Нет предприятия&#62;';&#13;&#10;    CompName.Font.Color := clRed;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    CompName.Font.Color := clWindowText;&#13;&#10;&#13;&#10;  CompName.Text := CName;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure CompIDOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  edtCompID.Text := ВыборСпискаИзСправочника('r_Comps;CompID;CompName;');&#13;&#10;end;&#13;&#10;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure CodeID1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes1.Text := ВыборСпискаИзСправочника('r_Codes1;CodeID1;CodeName1;' + Codes1.Text);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure OurIDOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Ours.Text := ВыборСпискаИзСправочника('r_Ours;OurID;OurName;' + Ours.Text);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure CodeID2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes2.Text := ВыборСпискаИзСправочника('r_Codes2;CodeID2;CodeName2;' + Codes2.Text);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure CodeID3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Codes3.Text := ВыборСпискаИзСправочника('r_Codes3;CodeID3;CodeName3;' + Codes3.Text);&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure ctl_PeriodOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  p: string;&#13;&#10;begin&#13;&#10;  p := ВыборПериода(ctl_Start.Date, ctl_End.Date, 13);&#13;&#10;  if p = '' then Exit;&#13;&#10;  ctl_Start.Date := StrToDate(ПараметрИзСтроки(1, p, ';'));&#13;&#10;  ctl_End.Date := StrToDate(ПараметрИзСтроки(2, p, ';'));&#13;&#10;end;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;procedure sbBrExportPathOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with TSaveDialog.Create(Report) do&#13;&#10;  try&#13;&#10;    Filter := 'Файлы экспорта (*.xml)|*.xml;';&#13;&#10;    Options := ofEnableSizing + ofPathMustExist;&#13;&#10;    InitialDir := ExtractFilePath(edtExportPath.Text);&#13;&#10;    FileName := 'Фирма_X_yyyy-mm-dd-hh-nn-ss_' + БДПоиск('SUBSTRING(CAST(NEWID() AS VARCHAR(100)),1,8)', '', '') + '.XML';&#13;&#10;    if not Execute then Exit;&#13;&#10;    edtExportPath.Text := ExtractFilePath(FileName);&#13;&#10;    Реестр_Записать('MRU', edtExportPath.Text, RegPath);&#13;&#10;  finally&#13;&#10;    Free;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;function IncludeTrailingPathDelimiter(const S: string): string;&#13;&#10;begin&#13;&#10;  Result := Trim(S);&#13;&#10;  if Length(Result) &#62; 0 then&#13;&#10;    if Result[Length(Result)] &#60;&#62; PathDelim then&#13;&#10;      Result := Result + PathDelim;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Header1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CHild1.Visible := not (&#60;Page&#62; = 1);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CHild1.Visible := True;&#13;&#10;end;&#13;&#10;&#13;&#10;Procedure WaitShow;&#13;&#10;Begin&#13;&#10;  pan_Wait.Visible:= True;&#13;&#10;  Application.ProcessMessages;&#13;&#10;End;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;Procedure WaitHide;&#13;&#10;Begin&#13;&#10;  pan_Wait.Visible:= False;&#13;&#10;  Application.ProcessMessages;&#13;&#10;End;&#13;&#10;{------------------------------------------------------------------------------}&#13;&#10;&#13;&#10;begin&#13;&#10;//  RaiseException('Инструмент временно недоступен');&#13;&#10;end.    " StoreInDFM="False" OnStopReport="frxReportOnStopReport" PropData="044C656674022803546F70020F0844617461736574730101062820446174615365743D2264715F4D61696E2220446174615365744E616D653D2264715F4D61696E220001062620446174615365743D2264715F52756E2220446174615365744E616D653D2264715F52756E220001062C20446174615365743D2264715F5374617465732220446174615365744E616D653D2264715F537461746573220001062820446174615365743D2264715F4F7572732220446174615365744E616D653D2264715F4F757273220000095661726961626C657301010619204E616D653D2220474D53204F666669636520546F6F6C73220001060F204E616D653D22446F6343684944220001061A204E616D653D224F6666696365546F6F6C7346696C74657231220001061A204E616D653D224F6666696365546F6F6C7346696C74657232220001061A204E616D653D224F6666696365546F6F6C7346696C74657233220001061A204E616D653D224F6666696365546F6F6C7346696C746572342200010611204E616D653D2250726963654C697374220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="dq_Main" UserName="dq_Main" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT NULL" DatabaseName="dbMain" SessionName="Default" PropData="05704C656674024C0470546F7002380A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_Run" UserName="dq_Run" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="dq_Main" IgnoreDupParams="False" SQL.Text="" DatabaseName="dbMain" SessionName="Default" PropData="05704C6566740390000470546F7002380A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_States" UserName="dq_States" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT StateCode, CAST(CAST(StateCode AS VARCHAR(10)) + ' - ' + StateName AS VARCHAR(250)) StateName&#13;&#10;FROM dbo.r_States WITH(NOLOCK)&#13;&#10;WHERE StateCode IN (190,193,194)&#13;&#10;ORDER BY 1" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667403D8000470546F7002380A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_Ours" UserName="dq_Ours" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT OurID, CAST(OurID AS VARCHAR(8)) + ' - ' + OurName OurName, Code         &#13;&#10;FROM dbo.r_Ours WITH(NOLOCK)&#13;&#10;WHERE OurID IN (SELECT AValue FROM dbo.zf_FilterToTable(:Ours))&#13;&#10;ORDER BY 1                        " DatabaseName="dbMain" SessionName="Default" PropData="05704C6566740320010470546F7002380A506172616D657465727301010620204E616D653D224F757273222044617461547970653D226674537472696E67220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" TitleBeforeHeader="False" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="143,62214" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="dq_Main" DataSetName="dq_Main" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="71,81107" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haCenter" ParentFont="False" Text="[dq_Main.&#34;TaxDocDate&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="71,81107" Top="0" Width="75,5906" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[dq_Main.&#34;TaxDocID&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="147,40167" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[dq_Main.&#34;SumCC_wt&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="238,11039" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[dq_Main.&#34;SumCC_nt&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="328,81911" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[dq_Main.&#34;TaxSum&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="419,52783" Top="0" Width="60,47248" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[dq_Main.&#34;CompID&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="480,00031" Top="0" Width="238,11039" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" ParentFont="False" Text="[dq_Main.&#34;Contract1&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="11,33859" Left="0" Top="264,5671" Width="718,1107">
      <TfrxMemoView Name="Memo20" Align="baClient" Left="0" Top="0" Width="718,1107" Height="11,33859" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Calibri" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Стр. [Page] / [TotalPages]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="22,67718" Left="0" Top="41,57483" Width="718,1107" OnBeforePrint="GroupHeader1OnBeforePrint" Child="Child1" Condition="dq_Main.&#34;OurID&#34;" OutlineText="dq_Main.&#34;OurID&#34;" ResetPageNumbers="True" StartNewPage="True">
      <TfrxMemoView Name="Memo22" Align="baClient" Left="0" Top="0" Width="718,1107" Height="22,67718" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" GapX="4" ParentFont="False" Text="[БДПоиск('OurName', 'r_Ours', 'OurID=' + STR(&#60;dq_Main.&#34;OurID&#34;&#62;))] ([dq_Main.&#34;OurID&#34;])"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="18,89765" Left="0" Top="185,19697" Width="718,1107">
      <TfrxMemoView Name="Memo8" Left="147,40167" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;dq_Main.&#34;SumCC_wt&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo9" Left="238,11039" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;dq_Main.&#34;SumCC_nt&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo10" Left="328,81911" Top="0" Width="90,70872" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;dq_Main.&#34;TaxSum&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo18" Left="0" Top="0" Width="147,40167" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="Итого по Ф.[dq_Main.&#34;OurID&#34;]:"/>
      <TfrxMemoView Name="Memo19" Left="480,00031" Top="0" Width="238,11039" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo21" Left="419,52783" Top="0" Width="60,47248" Height="18,89765" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2n" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" Text="[Line] док."/>
    </TfrxGroupFooter>
    <TfrxChild Name="Child1" Height="34,01577" Left="0" Top="86,92919" Width="718,1107">
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="71,81107" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата налоговой"/>
      <TfrxMemoView Name="Memo12" Left="71,81107" Top="0" Width="75,5906" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Номер налоговой"/>
      <TfrxMemoView Name="Memo13" Left="147,40167" Top="0" Width="90,70872" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Сумма с НДС"/>
      <TfrxMemoView Name="Memo14" Left="238,11039" Top="0" Width="90,70872" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Сумма без НДС"/>
      <TfrxMemoView Name="Memo15" Left="328,81911" Top="0" Width="90,70872" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Сумма&#13;&#10;НДС"/>
      <TfrxMemoView Name="Memo16" Left="419,52783" Top="0" Width="60,47248" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Код"/>
      <TfrxMemoView Name="Memo17" Left="480,00031" Top="0" Width="238,11039" Height="34,01577" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Имя предприятия"/>
    </TfrxChild>
    <TfrxHeader Name="Header1" Height="0" Left="0" Top="18,89765" Width="718,1107" OnBeforePrint="Header1OnBeforePrint" Child="Child1" ReprintOnNewPage="True"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="dlg_Filter" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Экспорт Me.Doc: Параметры" Height="634" ClientHeight="606" Left="736" Top="203" Width="448" ClientWidth="442" OnShow="dlg_FilterOnShow">
    <TfrxGroupBoxControl Name="GroupBox1" Left="8" Top="8" Width="336" Height="100" ShowHint="True" Caption="  Период  " Color="-16777201">
      <TfrxDateEditControl Name="ctl_Start" Left="12" Top="36" Width="152" Height="20" ShowHint="True" Color="-16777211" Date="42430,0394149653" Time="42430,0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label2" Left="12" Top="16" Width="152" Height="16" ShowHint="True" AutoSize="False" Caption="Начальная дата:" Color="-16777201"/>
      <TfrxDateEditControl Name="ctl_End" Left="180" Top="36" Width="152" Height="20" ShowHint="True" Color="-16777211" Date="42437,0394149653" Time="42437,0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label4" Left="180" Top="16" Width="75" Height="13" ShowHint="True" AutoSize="False" Caption="Конечная дата:" Color="-16777201"/>
      <TfrxSpeedButtonControl Name="ctl_Period" Left="240" Top="64" Width="92" Height="24" GroupIndex="0" ShowHint="True" Caption="Выбор периода" OnClick="ctl_PeriodOnClick"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox2" Left="8" Top="112" Width="336" Height="72" ShowHint="True" Caption=" Выбор документа " Color="-16777201">
      <TfrxRadioButtonControl Name="rbInv" Left="8" Top="20" Width="137" Height="17" ShowHint="True" Caption="Налоговая накладная" Checked="True" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbRet" Left="160" Top="20" Width="173" Height="17" ShowHint="True" Caption="Корректировочная накладная" TabStop="False" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbPrepay" Left="8" Top="44" Width="153" Height="17" ShowHint="True" Caption="Накладная на предоплату" TabStop="False" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbPlanRec" Left="160" Top="44" Width="173" Height="17" ShowHint="True" Caption="Планирование: Доходы" TabStop="False" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxLabelControl Name="Label6" Left="8" Top="232" Width="156" Height="16" ShowHint="True" AutoSize="False" Caption="Внутренняя фирма:" Color="-16777201"/>
    <TfrxEditControl Name="Ours" Left="492" Top="248" Width="304" Height="20" Enabled="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxEditControl Name="Codes1" Left="8" Top="288" Width="304" Height="20" Enabled="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="52-79"/>
    <TfrxEditControl Name="Codes2" Left="8" Top="328" Width="304" Height="20" Enabled="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="18,19,48,69,43,38,44,58,84,88,89,30,56"/>
    <TfrxLabelControl Name="Label7" Left="8" Top="312" Width="156" Height="16" Enabled="False" ShowHint="True" AutoSize="False" Caption="Признаки 2:" Color="-16777201"/>
    <TfrxLabelControl Name="Label8" Left="8" Top="352" Width="156" Height="16" Enabled="False" ShowHint="True" AutoSize="False" Caption="Признаки 3:" Color="-16777201"/>
    <TfrxLabelControl Name="Label11" Left="8" Top="272" Width="156" Height="16" Enabled="False" ShowHint="True" AutoSize="False" Caption="Признаки 1:" Color="-16777201"/>
    <TfrxEditControl Name="Codes3" Left="8" Top="368" Width="304" Height="20" Enabled="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="4"/>
    <TfrxSpeedButtonControl Name="OurID" Left="804" Top="248" Width="24" Height="20" GroupIndex="0" Enabled="False" ShowHint="True" Caption="..." OnClick="OurIDOnClick"/>
    <TfrxSpeedButtonControl Name="CodeID2" Left="320" Top="328" Width="24" Height="20" GroupIndex="0" Enabled="False" ShowHint="True" Caption="..." OnClick="CodeID2OnClick"/>
    <TfrxSpeedButtonControl Name="CodeID3" Left="320" Top="368" Width="24" Height="20" GroupIndex="0" Enabled="False" ShowHint="True" Caption="..." OnClick="CodeID3OnClick"/>
    <TfrxSpeedButtonControl Name="CodeID1" Left="320" Top="288" Width="24" Height="20" GroupIndex="0" Enabled="False" ShowHint="True" Caption="..." OnClick="CodeID1OnClick"/>
    <TfrxButtonControl Name="ctl_Ok" Left="352" Top="12" Width="76" Height="24" ShowHint="True" Caption="OK" Default="True" OnClick="ctl_OkOnClick"/>
    <TfrxButtonControl Name="Button2" Left="352" Top="44" Width="76" Height="24" ShowHint="True" Cancel="True" Caption="Отмена" ModalResult="2"/>
    <TfrxGroupBoxControl Name="GroupBox3" Left="8" Top="440" Width="336" Height="152" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption=" Дополнительный фильтр " Color="-16777201">
      <TfrxEditControl Name="edtCompID" Left="12" Top="36" Width="44" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="0" OnChange="CompsOnChange" OnKeyPress="CompsOnKeyPress"/>
      <TfrxEditControl Name="CompName" Left="60" Top="36" Width="240" Height="20" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="Нет Предприятия"/>
      <TfrxLabelControl Name="Label9" Left="12" Top="20" Width="100" Height="16" ShowHint="True" AutoSize="False" Caption="Предприятие:" Color="-16777201"/>
      <TfrxButtonControl Name="CompID" Left="308" Top="36" Width="24" Height="20" ShowHint="True" Caption="..." TabStop="False" OnClick="CompIDOnClick"/>
      <TfrxCheckBoxControl Name="ctl_IsConsCode" Left="12" Top="64" Width="300" Height="16" ShowHint="True" Caption="Код является консолидированным" Color="-16777201" OnClick="CompsOnChange"/>
      <TfrxLabelControl Name="Label1" Left="12" Top="92" Width="148" Height="16" ShowHint="True" AutoSize="False" Caption="Номер налоговой:" Color="-16777201"/>
      <TfrxEditControl Name="edtTaxDocID" Left="12" Top="108" Width="304" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxCheckBoxControl Name="cbConsolidated" Left="12" Top="132" Width="300" Height="16" ShowHint="True" Caption="Консолидированный документ" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxLabelControl Name="Label3" Left="8" Top="392" Width="156" Height="16" ShowHint="True" AutoSize="False" Caption="Статус:" Color="-16777201"/>
    <TfrxLabelControl Name="Label5" Left="8" Top="192" Width="110" Height="13" ShowHint="True" Caption="Путь к папке обмена:" Color="-16777201"/>
    <TfrxEditControl Name="edtExportPath" Left="8" Top="208" Width="304" Height="20" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="C:\Users\revak\Documents\"/>
    <TfrxSpeedButtonControl Name="sbBrExportPath" Left="320" Top="208" Width="24" Height="20" GroupIndex="0" ShowHint="True" Caption="..." OnClick="sbBrExportPathOnClick"/>
    <TfrxPanelControl Name="pan_Wait" Left="80" Top="268" Width="272" Height="40" ShowHint="True" Visible="False" Caption="Обработка данных. Подождите минутку..." Color="12639424"/>
    <TfrxDBLookupComboBox Name="cbStates" Left="8" Top="408" Width="333" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="dq_States" DataSetName="dq_States" ListField="StateName" KeyField="StateCode" DropDownWidth="0" DropDownRows="7"/>
    <TfrxDBLookupComboBox Name="cbOurs" Left="8" Top="248" Width="304" Height="20" ShowHint="True" DataSet="dq_Ours" DataSetName="dq_Ours" ListField="OurName" KeyField="OurID" DropDownWidth="0" DropDownRows="7"/>
  </TfrxDialogPage>
</TfrxReport>
