USE Elit;

select DISTINCT (select ExtProdID   from r_ProdEC ec WHERE ec.ProdID = mp.ProdID AND CompID = 7031) 'Артикул покупця'
,round(mp.PriceMC * 29/1.2,2) 'Ціна без ПДВ'
from dbo.r_ProdMP mp
 WHERE ProdID in (select ProdID from r_ProdEC ec WHERE ExtProdID in (
'173411','173410','3181','248190','248191','248189','248192','174004','71183','71181','285588','286124','286122','286123','286120','286125','286126','286121','71178','71179','71177','310859','310861','310862','310863','240101','19445','7255','287194','287193','287191','287192','287195','19439','19450','19447','19449','19451','287196','287197','278175','278179','278176','278178','278180','278177','41771','173413','41769','41767','41768','44889','303320','303318','303319','173418','173419','173414','173412','10333','10487','10471','287189','10478','173417','287190','173415','41758','41770','41759','41761','41756','274176'
) AND CompID = 7031) AND mp.PLID = 99
ORDER by 1

/*
select * from r_ProdEC ec WHERE ExtProdID in ('173411','173410','3181','248190','248191','248189','248192','174004','71183','71181','285588','286124','286122','286123','286120','286125','286126','286121','71178','71179','71177','310859','310861','310862','310863','240101','19445','7255','287194','287193','287191','287192','287195','19439','19450','19447','19449','19451','287196','287197','278175','278179','278176','278178','278180','278177','41771','173413','41769','41767','41768','44889','303320','303318','303319','173418','173419','173414','173412','10333','10487','10471','287189','10478','173417','287190','173415','41758','41770','41759','41761','41756','274176') AND CompID = 7031

select *, (select ExtProdID   from r_ProdEC ec WHERE ec.ProdID = mp.ProdID AND CompID = 7031),round(mp.PriceMC * 29/1.2,2) from dbo.r_ProdMP mp WHERE ProdID in (select ProdID from r_ProdEC ec WHERE ExtProdID in ('45350','45351','45352','45353') AND CompID = 7031) AND mp.PLID = 99

select '173411',(select ProdID from r_ProdEC ec WHERE ExtProdID in ('173411') AND CompID = 7031),round(mp.PriceMC * 29/1.2,2) from dbo.r_ProdMP mp WHERE ProdID in (select ProdID from r_ProdEC ec WHERE ExtProdID in ('173411') AND CompID = 7031) AND mp.PLID = 99

*/
