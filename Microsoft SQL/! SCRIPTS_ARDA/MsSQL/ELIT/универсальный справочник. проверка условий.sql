--это будет работать в базе Elit, тестируем в Elit_TEST (rkv0-20190115)
USE Elit_TEST	

  DECLARE @SQL NVARCHAR(MAX)
  DECLARE @SQL_Update NVARCHAR(MAX)
  DECLARE @Filter NVARCHAR(MAX)
  DECLARE @Case NVARCHAR(MAX)

--@Filter
	SET @Filter = ''

    SELECT @Filter += CASE WHEN @Filter = '' THEN '' ELSE ' OR ' END + Txt
    FROM(
		SELECT Txt = N' (' + RefName + ' AND DepID <> ' + Notes +')'
		FROM dbo.r_Uni WITH(NOLOCK)
		WHERE RefTypeID = 6680115 AND RefID != 0
		AND ISNULL(RefName,'') != '' AND ISNUMERIC(Notes) = 1
		) AS m
    
	SELECT @Filter 'Filter'
 
	SET @Case = ''
    SELECT @Case += Txt
    FROM(
		SELECT Txt = N' WHEN ' + RefName + ' THEN ' + Notes
		FROM dbo.r_Uni WITH(NOLOCK)
		WHERE RefTypeID = 6680115 AND RefID != 0
		AND ISNULL(RefName,'') != '' AND ISNUMERIC(Notes) = 1
		) AS m
   
--@Case
	SELECT @Case 'Case'

 
	SET @SQL = 'SELECT COUNT(*) as ''Кол'', ''t_Rec'' as ''Документ''  FROM t_Rec WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ') UNION '
			 + 'SELECT COUNT(*), ''t_Ret'' FROM t_Ret WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ') UNION '
			 + 'SELECT COUNT(*), ''t_Epp'' FROM t_Epp WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ') UNION '
			 + 'SELECT COUNT(*), ''t_Exp'' FROM t_Exp WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ') UNION '
			 + 'SELECT COUNT(*), ''c_CompExp'' FROM c_CompExp WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'
    
	SET @SQL_Update = 'UPDATE m SET DepID = CASE ' + @Case + ' ELSE DepID END FROM t_Rec m     WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'
					+ 'UPDATE m SET DepID = CASE ' + @Case + ' ELSE DepID END FROM t_Ret m     WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'
					+ 'UPDATE m SET DepID = CASE ' + @Case + ' ELSE DepID END FROM t_Epp m     WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'
					+ 'UPDATE m SET DepID = CASE ' + @Case + ' ELSE DepID END FROM t_Exp m     WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'
					+ 'UPDATE m SET DepID = CASE ' + @Case + ' ELSE DepID END FROM c_CompExp m WHERE DocDate > ''2018-12-01'' AND (' + @Filter + ');'


	SELECT @SQL 'SQL SELECT'
	SELECT @SQL_Update 'SQL UPDATE'


    EXEC SP_EXECUTESQL @SQL --, N'@Count_Rec INT OUT', @Count_Rec OUT


	--BEGIN TRAN

	----EXEC SP_EXECUTESQL @SQL_Update
	----EXEC SP_EXECUTESQL @SQL

	--ROLLBACK TRAN

	
/*
SELECT * FROM dbo.r_Uni WITH(NOLOCK)
    WHERE RefTypeID = 6680115 AND RefID != 0
    AND ISNULL(RefName,'') != ''

	--insert r_Uni
	SELECT * FROM Elit.dbo.r_Uni WHERE RefTypeID = 6680115 

	--delete dbo.r_Uni WHERE RefTypeID = 6680115 

--go
*/

--  DECLARE @ContrTypeID INT 
--  DECLARE @SQL NVARCHAR(MAX) 

-- SET @SQL ='SELECT 	@ContrTypeID = (  
--		  SELECT 1 ContrTypeID    FROM (SELECT 2000 CodeID4, 2128 CodeID5, 5 DepID) m WHERE CodeID4 = 2000 AND CodeID5 = 2053 AND DepID = 5 
--	UNION SELECT 2 ContrTypeID    FROM (SELECT 2000 CodeID4, 2128 CodeID5, 5 DepID) m WHERE CodeID4 = 2000 AND CodeID5 = 2127 AND DepID = 5 
--	UNION SELECT 3 ContrTypeID    FROM (SELECT 2000 CodeID4, 2128 CodeID5, 5 DepID) m WHERE CodeID4 = 2000 AND CodeID5 = 2128 AND DepID = 5 
--	)'
--    EXEC sp_executesql @SQL, N'@ContrTypeID INT OUT', @ContrTypeID OUT

-- SELECT @ContrTypeID

/*
SELECT top 10000 * FROM t_Rec where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5)
SELECT top 10000 * FROM t_Ret where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5)
SELECT top 10000 * FROM t_Epp where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5)
SELECT top 10000 * FROM t_Exp where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5)
SELECT top 100000 * FROM c_CompExp where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5)

SELECT * FROM z_tables

SELECT count(*) FROM c_CompExp

SELECT * FROM c_CompExp where (CodeID4 = 2000 AND CodeID5 = 2053 AND DepID <> 5 ) or (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID <> 5 ) 

*/

--SELECT count(*) FROM t_Rec where DocDate > '2018-12-01' AND ((CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5))

/*
BEGIN TRAN

SELECT count(*) FROM t_Rec where DocDate > '2018-12-01' AND ((CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5))
SELECT * FROM t_Rec where DocDate > '2018-12-01' AND ((CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5))

UPDATE m SET DepID = CASE 
 WHEN CodeID4 = 2000 AND CodeID5 = 2053 THEN 5 WHEN CodeID4 = 2000 AND CodeID5 = 2127 THEN 5 WHEN CodeID4 = 2000 AND CodeID5 = 2128 THEN 5 WHEN CodeID4 = 2000 AND CodeID5 = 2129 THEN 5 WHEN CodeID4 = 2000 AND CodeID5 = 2130 THEN 5 WHEN CodeID4 = 2001 AND CodeID5 = 2018 THEN 5 WHEN CodeID4 = 2002 AND CodeID5 = 2012 THEN 5 WHEN CodeID4 = 2002 AND CodeID5 = 2018 THEN 5 WHEN CodeID4 = 2004 AND CodeID5 = 2062 THEN 5 WHEN CodeID4 = 2005 AND CodeID5 = 2067 THEN 5 WHEN CodeID4 = 2006 AND CodeID5 = 2022 THEN 3 WHEN CodeID4 = 2008 AND CodeID5 = 2055 THEN 5 WHEN CodeID4 = 2009 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2010 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2011 AND CodeID5 = 2028 THEN 5 WHEN CodeID4 = 2011 AND CodeID5 = 2029 THEN 5 WHEN CodeID4 = 2011 AND CodeID5 = 2032 THEN 5 WHEN CodeID4 = 2012 AND CodeID5 = 2012 THEN 5 WHEN CodeID4 = 2012 AND CodeID5 = 2013 THEN 5 WHEN CodeID4 = 2012 AND CodeID5 = 2017 THEN 5 WHEN CodeID4 = 2012 AND CodeID5 = 2020 THEN 5 WHEN CodeID4 = 2012 AND CodeID5 = 2066 THEN 5 WHEN CodeID4 = 2013 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2014 AND CodeID5 = 2068 THEN 5 WHEN CodeID4 = 2014 AND CodeID5 = 2056 THEN 5 WHEN CodeID4 = 2014 AND CodeID5 = 2057 THEN 5 WHEN CodeID4 = 2014 AND CodeID5 = 2060 THEN 5 WHEN CodeID4 = 2014 AND CodeID5 = 2061 THEN 5 WHEN CodeID4 = 2014 AND CodeID5 = 2062 THEN 5 WHEN CodeID4 = 2015 AND CodeID5 = 2015 THEN 5 WHEN CodeID4 = 2016 AND CodeID5 = 2014 THEN 5 WHEN CodeID4 = 2016 AND CodeID5 = 2030 THEN 5 WHEN CodeID4 = 2016 AND CodeID5 = 2033 THEN 5 WHEN CodeID4 = 2018 AND CodeID5 = 2018 THEN 5 WHEN CodeID4 = 2019 AND CodeID5 = 2026 THEN 5 WHEN CodeID4 = 2019 AND CodeID5 = 2063 THEN 5 WHEN CodeID4 = 2019 AND CodeID5 = 2071 THEN 5 WHEN CodeID4 = 2020 AND CodeID5 = 2057 THEN 8 WHEN CodeID4 = 2020 AND CodeID5 = 2062 THEN 8 WHEN CodeID4 = 2021 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2022 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2023 AND CodeID5 = 2022 THEN 3 WHEN CodeID4 = 2026 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2028 AND CodeID5 = 2018 THEN 6 WHEN CodeID4 = 2030 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2030 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2031 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2031 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2032 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2034 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2034 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2035 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2035 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2036 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2036 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2039 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2048 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2048 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2052 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2075 AND CodeID5 = 2006 THEN 4 WHEN CodeID4 = 2098 AND CodeID5 = 2010 THEN 1 WHEN CodeID4 = 2098 AND CodeID5 = 2008 THEN 3 WHEN CodeID4 = 2099 AND CodeID5 = 2007 THEN 7 WHEN CodeID4 = 2101 AND CodeID5 = 2051 THEN 5 WHEN CodeID4 = 2102 AND CodeID5 = 2090 THEN 5 WHEN CodeID4 = 2105 AND CodeID5 = 2110 THEN 5 WHEN CodeID4 = 2106 AND CodeID5 = 2085 THEN 5 WHEN CodeID4 = 2106 AND CodeID5 = 2086 THEN 5 WHEN CodeID4 = 2106 AND CodeID5 = 2087 THEN 5 WHEN CodeID4 = 2106 AND CodeID5 = 2091 THEN 5 WHEN CodeID4 = 2107 AND CodeID5 = 2011 THEN 5 WHEN CodeID4 = 2108 AND CodeID5 = 2093 THEN 5 WHEN CodeID4 = 2108 AND CodeID5 = 2094 THEN 5 WHEN CodeID4 = 2109 AND CodeID5 = 2099 THEN 5 WHEN CodeID4 = 2109 AND CodeID5 = 2100 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2118 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2120 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2121 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2122 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2123 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2124 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2125 THEN 5 WHEN CodeID4 = 2110 AND CodeID5 = 2126 THEN 5 WHEN CodeID4 = 2112 AND CodeID5 = 2112 THEN 5 WHEN CodeID4 = 2112 AND CodeID5 = 2115 THEN 5
 ELSE DepID END FROM t_Rec m where DocDate > '2018-12-01' AND ((CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5))

SELECT COUNT(*) FROM t_Rec where DocDate > '2018-12-01' AND ((CodeID4 = 2000 AND CodeID5 = 2053 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2127 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2128 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2129 AND DepID != 5) OR (CodeID4 = 2000 AND CodeID5 = 2130 AND DepID != 5) OR (CodeID4 = 2001 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2002 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2004 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2005 AND CodeID5 = 2067 AND DepID != 5) OR (CodeID4 = 2006 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2008 AND CodeID5 = 2055 AND DepID != 5) OR (CodeID4 = 2009 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2010 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2011 AND CodeID5 = 2028 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2029 AND DepID != 5) OR (CodeID4 = 2011 AND CodeID5 = 2032 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2012 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2013 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2017 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2020 AND DepID != 5) OR (CodeID4 = 2012 AND CodeID5 = 2066 AND DepID != 5) OR (CodeID4 = 2013 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2014 AND CodeID5 = 2056 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2057 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2060 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2061 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2062 AND DepID != 5) OR (CodeID4 = 2014 AND CodeID5 = 2068 AND DepID != 5) OR (CodeID4 = 2015 AND CodeID5 = 2015 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2014 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2030 AND DepID != 5) OR (CodeID4 = 2016 AND CodeID5 = 2033 AND DepID != 5) OR (CodeID4 = 2018 AND CodeID5 = 2018 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2026 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2063 AND DepID != 5) OR (CodeID4 = 2019 AND CodeID5 = 2071 AND DepID != 5) OR (CodeID4 = 2020 AND CodeID5 = 2057 AND DepID != 8) OR (CodeID4 = 2020 AND CodeID5 = 2062 AND DepID != 8) OR (CodeID4 = 2021 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2022 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2023 AND CodeID5 = 2022 AND DepID != 3) OR (CodeID4 = 2026 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2028 AND CodeID5 = 2018 AND DepID != 6) OR (CodeID4 = 2030 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2030 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2031 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2031 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2032 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2034 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2034 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2035 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2035 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2036 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2036 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2039 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2048 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2048 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2052 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2075 AND CodeID5 = 2006 AND DepID != 4) OR (CodeID4 = 2098 AND CodeID5 = 2008 AND DepID != 3) OR (CodeID4 = 2098 AND CodeID5 = 2010 AND DepID != 1) OR (CodeID4 = 2099 AND CodeID5 = 2007 AND DepID != 7) OR (CodeID4 = 2101 AND CodeID5 = 2051 AND DepID != 5) OR (CodeID4 = 2102 AND CodeID5 = 2090 AND DepID != 5) OR (CodeID4 = 2105 AND CodeID5 = 2110 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2085 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2086 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2087 AND DepID != 5) OR (CodeID4 = 2106 AND CodeID5 = 2091 AND DepID != 5) OR (CodeID4 = 2107 AND CodeID5 = 2011 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2093 AND DepID != 5) OR (CodeID4 = 2108 AND CodeID5 = 2094 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2099 AND DepID != 5) OR (CodeID4 = 2109 AND CodeID5 = 2100 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2118 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2120 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2121 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2122 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2123 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2124 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2125 AND DepID != 5) OR (CodeID4 = 2110 AND CodeID5 = 2126 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2112 AND DepID != 5) OR (CodeID4 = 2112 AND CodeID5 = 2115 AND DepID != 5))

ROLLBACK TRAN


*/


/*
  SET @SQL = ''
    SELECT @SQL = @SQL + Txt
    FROM(
    SELECT Txt = N' UNION SELECT ' + CAST(RefID AS NVARCHAR(10)) + N' ContrTypeID
    FROM (SELECT ' + CAST(@CodeID4 AS NVARCHAR(10)) + N' CodeID4, ' +
    CAST(@CodeID5 AS NVARCHAR(10)) + N' CodeID5, ' +
    CAST(@DepID AS NVARCHAR(10)) + N' DepID) m WHERE ' + RefName
    FROM dbo.r_Uni WITH(NOLOCK)
    WHERE RefTypeID = 6680115 AND RefID != 0
    AND ISNULL(RefName,'') != '') m
    
    SET @SQL = 'SELECT 	@ContrTypeID = (' + SUBSTRING(@SQL,8,16235222) + ')'
	 SELECT @SQL

    EXEC sp_executesql @SQL, N'@ContrTypeID INT OUT', @ContrTypeID OUT

	SELECT @ContrTypeID

*/