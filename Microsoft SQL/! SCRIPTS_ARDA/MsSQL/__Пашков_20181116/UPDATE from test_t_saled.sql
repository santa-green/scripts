select * from test_t_sale  --2577

select * from test_t_saled --7280


select * from t_sale where ChID in (select ChID from test_t_sale)

select * from t_saled where ChID in (select ChID from test_t_saled)



select * from t_saled where ChID in (select ChID from test_t_saled)
except
select * from test_t_saled
100393139,100392300,100393146,100391247,100391313,100389702,100389925,100391322,100391740,100393147

select * from t_saled where ChID in (100393139,100392300,100393146,100391247,100391313,100389702,100389925,100391322,100391740,100393147)
select * from test_t_saled where ChID in (100393139,100392300,100393146,100391247,100391313,100389702,100389925,100391322,100391740,100393147)

ChID	SrcPosID	ProdID	PPID	UM	Qty	PriceCC_nt	SumCC_nt	Tax	TaxSum	PriceCC_wt	SumCC_wt	BarCode	SecID	PurPriceCC_nt	PurTax	PurPriceCC_wt	PLID	Discount	DepID	IsFiscal	SubStockID	OutQty	EmpID	CreateTime	ModifyTime	TaxTypeID	RealPrice	RealSum
100389702	1	605424	415	пл€ш	2.000000000	38.095000000	76.190000000	7.615000000	15.230000000	45.710000000	91.420000000	605424	1	40.000000000	7.615000000	48.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.220	2016-11-18 14:48:21.220	0	48.000000000	96.000000000
100389925	1	603026	382	пл€ш	1.000000000	315.873000000	315.873000000	63.177000000	63.177000000	379.050000000	379.050000000	8010719001658	1	331.670000000	63.177000000	398.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.267	2016-11-18 14:48:21.267	0	398.000000000	398.000000000
100389925	2	607408	3	пл€ш	4.000000000	13.492000000	53.968000000	2.698000000	10.792000000	16.190000000	64.760000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.273	2016-11-18 14:48:21.273	0	17.000000000	68.000000000
100391247	1	607408	3	пл€ш	2.000000000	13.492000000	26.984000000	2.698000000	5.396000000	16.190000000	32.380000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.757	2016-11-18 14:48:21.757	0	17.000000000	34.000000000
100391313	1	607408	3	пл€ш	1.000000000	13.492000000	13.492000000	2.698000000	2.698000000	16.190000000	16.190000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.853	2016-11-18 14:48:21.853	0	17.000000000	17.000000000
100391322	1	605143	366	пл€ш	2.000000000	33.333000000	66.666000000	6.667000000	13.334000000	40.000000000	80.000000000	5000210014168	1	35.000000000	6.667000000	42.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.867	2016-11-18 14:48:21.867	0	42.000000000	84.000000000
100391322	2	605424	415	пл€ш	1.000000000	38.095000000	38.095000000	7.615000000	7.615000000	45.710000000	45.710000000	605424	1	40.000000000	7.615000000	48.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.873	2016-11-18 14:48:21.873	0	48.000000000	48.000000000
100391740	1	605424	416	пл€ш	1.000000000	38.095000000	38.095000000	7.615000000	7.615000000	45.710000000	45.710000000	605424	1	40.000000000	7.615000000	48.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:50:24.907	2016-11-18 14:50:24.907	0	48.000000000	48.000000000
100392300	1	607408	5	пл€ш	1.000000000	13.492000000	13.492000000	2.698000000	2.698000000	16.190000000	16.190000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:08.777	2016-11-28 16:15:08.777	0	17.000000000	17.000000000
100393139	1	607408	6	пл€ш	2.000000000	13.492000000	26.984000000	2.698000000	5.396000000	16.190000000	32.380000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:09.733	2016-11-28 16:15:09.733	0	17.000000000	34.000000000
100393146	1	607408	6	пл€ш	1.000000000	13.492000000	13.492000000	2.698000000	2.698000000	16.190000000	16.190000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:09.830	2016-11-28 16:15:09.830	0	17.000000000	17.000000000
100393147	1	607408	6	пл€ш	2.000000000	13.492000000	26.984000000	2.698000000	5.396000000	16.190000000	32.380000000	2900006074082	1	14.170000000	2.698000000	17.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:09.843	2016-11-28 16:15:09.843	0	17.000000000	34.000000000

ChID	SrcPosID	ProdID	PPID	UM	Qty	PriceCC_nt	SumCC_nt	Tax	TaxSum	PriceCC_wt	SumCC_wt	BarCode	SecID	PurPriceCC_nt	PurTax	PurPriceCC_wt	PLID	Discount	DepID	IsFiscal	SubStockID	OutQty	EmpID	CreateTime	ModifyTime	TaxTypeID	RealPrice	RealSum
100389702	1	605424	415	пл€ш	2.000000000	48.000000000	96.000000000	0.000000000	0.000000000	48.000000000	96.000000000	605424	1	40.000000000	7.615000000	48.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:00.000	2016-11-18 14:48:00.000	0	48.000000000	96.000000000
100389925	1	603026	382	пл€ш	1.000000000	315.873000000	315.873000000	63.177000000	63.177000000	379.050000000	379.050000000	8010719001658	1	331.670000000	63.177000000	398.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.267	2016-11-18 14:48:21.267	0	398.000000000	398.000000000
100389925	2	607408	3	пл€ш	4.000000000	17.000000000	68.000000000	0.000000000	0.000000000	17.000000000	68.000000000	2900006074082	1	14.170000000	2.698000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:00.000	2016-11-18 14:48:00.000	0	17.000000000	68.000000000
100391247	1	607408	3	пл€ш	2.000000000	17.000000000	34.000000000	0.000000000	0.000000000	17.000000000	34.000000000	2900006074082	1	14.170000000	2.698000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:00.000	2016-11-18 14:48:00.000	0	17.000000000	34.000000000
100391313	1	607408	3	пл€ш	1.000000000	17.000000000	17.000000000	0.000000000	0.000000000	17.000000000	17.000000000	2900006074082	1	14.170000000	2.698000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:00.000	2016-11-18 14:48:00.000	0	17.000000000	17.000000000
100391322	1	605143	366	пл€ш	2.000000000	33.333000000	66.666000000	6.667000000	13.334000000	40.000000000	80.000000000	5000210014168	1	35.000000000	6.667000000	42.000000000	77	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:21.867	2016-11-18 14:48:21.867	0	42.000000000	84.000000000
100391322	2	605424	415	пл€ш	1.000000000	40.000000000	40.000000000	8.000000000	8.000000000	48.000000000	48.000000000	605424	1	40.000000000	7.615000000	48.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:48:00.000	2016-11-18 14:48:00.000	0	48.000000000	48.000000000
100391740	1	605424	416	пл€ш	1.000000000	40.000000000	40.000000000	8.000000000	8.000000000	48.000000000	48.000000000	605424	1	40.000000000	7.615000000	48.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-18 14:50:00.000	2016-11-18 14:50:00.000	0	48.000000000	48.000000000
100392300	1	607408	5	пл€ш	1.000000000	17.000000000	17.000000000	0.000000000	0.000000000	17.000000000	17.000000000	2900006074082	1	17.000000000	0.000000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:00.000	2016-11-28 16:15:00.000	0	17.000000000	17.000000000
100393139	1	607408	6	пл€ш	2.000000000	17.000000000	34.000000000	0.000000000	0.000000000	17.000000000	34.000000000	2900006074082	1	17.000000000	0.000000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:00.000	2016-11-28 16:15:00.000	0	17.000000000	34.000000000
100393146	1	607408	6	пл€ш	1.000000000	17.000000000	17.000000000	0.000000000	0.000000000	17.000000000	17.000000000	2900006074082	1	17.000000000	0.000000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:00.000	2016-11-28 16:15:00.000	0	17.000000000	17.000000000
100393147	1	607408	6	пл€ш	2.000000000	17.000000000	34.000000000	0.000000000	0.000000000	17.000000000	34.000000000	2900006074082	1	17.000000000	0.000000000	17.000000000	0	0.000000000	0	1	0	1.000000000	0	2016-11-28 16:15:00.000	2016-11-28 16:15:00.000	0	17.000000000	34.000000000


UPDATE dbo.t_SaleD   
SET 
--dbo.t_SaleD.ChID =	dbo.test_T_saleD.ChID ,
--dbo.t_SaleD.SrcPosID =	dbo.test_T_saleD.SrcPosID ,
dbo.t_SaleD.ProdID =	dbo.test_T_saleD.ProdID ,
dbo.t_SaleD.PPID =	dbo.test_T_saleD.PPID ,
dbo.t_SaleD.UM =	dbo.test_T_saleD.UM ,
dbo.t_SaleD.Qty =	dbo.test_T_saleD.Qty ,
dbo.t_SaleD.PriceCC_nt =	dbo.test_T_saleD.PriceCC_nt ,
dbo.t_SaleD.SumCC_nt =	dbo.test_T_saleD.SumCC_nt ,
dbo.t_SaleD.Tax =	dbo.test_T_saleD.Tax ,
dbo.t_SaleD.TaxSum =	dbo.test_T_saleD.TaxSum ,
dbo.t_SaleD.PriceCC_wt =	dbo.test_T_saleD.PriceCC_wt ,
dbo.t_SaleD.SumCC_wt =	dbo.test_T_saleD.SumCC_wt ,
dbo.t_SaleD.BarCode =	dbo.test_T_saleD.BarCode ,
dbo.t_SaleD.SecID =	dbo.test_T_saleD.SecID ,
dbo.t_SaleD.PurPriceCC_nt =	dbo.test_T_saleD.PurPriceCC_nt ,
dbo.t_SaleD.PurTax =	dbo.test_T_saleD.PurTax ,
dbo.t_SaleD.PurPriceCC_wt =	dbo.test_T_saleD.PurPriceCC_wt ,
dbo.t_SaleD.PLID =	dbo.test_T_saleD.PLID ,
dbo.t_SaleD.Discount =	dbo.test_T_saleD.Discount ,
dbo.t_SaleD.DepID =	dbo.test_T_saleD.DepID ,
dbo.t_SaleD.IsFiscal =	dbo.test_T_saleD.IsFiscal ,
dbo.t_SaleD.SubStockID =	dbo.test_T_saleD.SubStockID ,
dbo.t_SaleD.OutQty =	dbo.test_T_saleD.OutQty ,
dbo.t_SaleD.EmpID =	dbo.test_T_saleD.EmpID ,
dbo.t_SaleD.CreateTime =	dbo.test_T_saleD.CreateTime ,
dbo.t_SaleD.ModifyTime =	dbo.test_T_saleD.ModifyTime ,
dbo.t_SaleD.TaxTypeID =	dbo.test_T_saleD.TaxTypeID ,
dbo.t_SaleD.RealPrice =	dbo.test_T_saleD.RealPrice ,
dbo.t_SaleD.RealSum=	dbo.test_T_saleD.RealSum

FROM dbo.t_SaleD   
    INNER JOIN dbo.test_T_saled   
    ON (dbo.t_SaleD.chid = dbo.test_T_saled.chid and dbo.t_SaleD.SrcPosID = dbo.test_T_saled.SrcPosID and dbo.test_T_saled.chid in (100393139,100392300,100393146,100391247,100391313,100389702,100389925,100391322,100391740,100393147))