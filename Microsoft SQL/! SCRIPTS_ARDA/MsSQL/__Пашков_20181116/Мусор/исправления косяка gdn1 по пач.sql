
--возврат как было из пач в пак
BEGIN TRAN

SELECT * FROM r_ProdMQ
WHERE  UM like 'пач%' and ProdID in 
(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)

DECLARE @ProdID INT, @UM varchar(20)
DECLARE CURSOR1 CURSOR LOCAL FAST_FORWARD
FOR 
SELECT ProdID, UM FROM r_ProdMQ WITH (NOLOCK)
WHERE UM like 'пач%' and 
	ProdID in
	(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)
GROUP BY 
	ProdID , UM

OPEN CURSOR1
	FETCH NEXT FROM CURSOR1 
	INTO @ProdID, @UM
WHILE @@FETCH_STATUS = 0
BEGIN
	--Script
	update r_ProdMQ
	set UM = REPLACE(UM,'пач','пак')
	WHERE  UM = @UM and ProdID = @ProdID
	
	FETCH NEXT FROM CURSOR1 
	INTO @ProdID, @UM
END
CLOSE CURSOR1
DEALLOCATE CURSOR1


SELECT * FROM z_ReplicaEvents where TableCode= 10350004
and PKValue like '601392%'
ORDER BY ReplicaEventID desc

SELECT * FROM r_ProdMQ
WHERE  UM like 'пак%' and ProdID in 
(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)


ROLLBACK TRAN



--обновление из пак в пач
BEGIN TRAN

SELECT * FROM r_ProdMQ
WHERE  UM like 'пак%' and ProdID in 
(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)

DECLARE @ProdID INT, @UM varchar(20)
DECLARE CURSOR1 CURSOR LOCAL FAST_FORWARD
FOR 
SELECT ProdID, UM FROM r_ProdMQ WITH (NOLOCK)
WHERE UM like 'пак%' and 
	ProdID in
	(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)
GROUP BY 
	ProdID , UM

OPEN CURSOR1
	FETCH NEXT FROM CURSOR1 
	INTO @ProdID, @UM
WHILE @@FETCH_STATUS = 0
BEGIN
	--Script
	update r_ProdMQ
	set UM = REPLACE(UM,'пак','пач')
	WHERE  UM = @UM and ProdID = @ProdID
	
	FETCH NEXT FROM CURSOR1 
	INTO @ProdID, @UM
END
CLOSE CURSOR1
DEALLOCATE CURSOR1


SELECT * FROM z_ReplicaEvents where TableCode= 10350004
and PKValue like '601392%'
ORDER BY ReplicaEventID desc

SELECT * FROM r_ProdMQ
WHERE  UM like 'пач%' and ProdID in 
(
601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
)

ROLLBACK TRAN





--BEGIN TRAN

--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пак%' and ProdID in 
--(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)

--DECLARE @ProdID INT, @UM varchar(20)
--DECLARE CURSOR1 CURSOR LOCAL FAST_FORWARD
--FOR 
--SELECT ProdID, UM FROM r_ProdMQ WITH (NOLOCK)
--WHERE UM like 'пак%' and 
--	ProdID in
--	(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)
--GROUP BY 
--	ProdID , UM

--OPEN CURSOR1
--	FETCH NEXT FROM CURSOR1 
--	INTO @ProdID, @UM
--WHILE @@FETCH_STATUS = 0
--BEGIN
--	--Script
--	update r_ProdMQ
--	set UM = REPLACE(UM,'пак','пач')
--	WHERE  UM = @UM and ProdID = @ProdID
	
--	FETCH NEXT FROM CURSOR1 
--	INTO @ProdID, @UM
--END
--CLOSE CURSOR1
--DEALLOCATE CURSOR1


--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пач%' and ProdID in 
--(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)

--ROLLBACK TRAN



----тестовая 1 позиция
--BEGIN TRAN

--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пак%' and ProdID in 
--(
--601392
--)

--DECLARE @ProdID INT, @UM varchar(20)
--DECLARE CURSOR1 CURSOR LOCAL FAST_FORWARD
--FOR 
--SELECT ProdID, UM FROM r_ProdMQ WITH (NOLOCK)
--WHERE UM like 'пак%' and 
--	ProdID in
--	(
--601392
--)
--GROUP BY 
--	ProdID , UM

--OPEN CURSOR1
--	FETCH NEXT FROM CURSOR1 
--	INTO @ProdID, @UM
--WHILE @@FETCH_STATUS = 0
--BEGIN
--	--Script
--	update r_ProdMQ
--	set UM = REPLACE(UM,'пак','пач')
--	WHERE  UM = @UM and ProdID = @ProdID
	
--	FETCH NEXT FROM CURSOR1 
--	INTO @ProdID, @UM
--END
--CLOSE CURSOR1
--DEALLOCATE CURSOR1


--SELECT * FROM z_ReplicaEvents where TableCode= 10350004
--and PKValue like '601392%'
--ORDER BY ReplicaEventID desc

--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пач%' and ProdID in 
--(
--601392
--)

--ROLLBACK TRAN

--SELECT * FROM r_Uni where RefTypeID = 80021


--BEGIN TRAN

--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пак%' and ProdID in 
--(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)

--update r_ProdMQ
--set UM = REPLACE(UM,'пак','пач')
--WHERE  UM like 'пак%' and ProdID in 
--(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)


----SELECT * FROM z_ReplicaEvents where TableCode= 10350004
----and PKValue like '601392%'
----ORDER BY ReplicaEventID desc

--SELECT * FROM r_ProdMQ
--WHERE  UM like 'пак%' and ProdID in 
--(
--601392,601393,601394,601395,601396,601397,601398,601399,601400,601401,601402,601403,601404,601405,601406,601407,601408,601409,601412,601413,601414,601419,601420,601421,601422,601423,601424,601427,601428,601429,601430,601431,601432,601433,601434,601435,601436,601437,601438,601439,601440,601441,601442,601443,601444,601445,601446,601449,601450,601451,601452,601453,601454,601455,601456,601457,601463,601464,601465,601466,601470,601471,601472,601473,601474,602876,604218,604219,604220,604221,604222,604223,604224,604225,604226,604227,604228,604229,604230,604231,604232,604233,604234,604235,604236,604237,604238,604239,604240,604241,604242,604243,604244,604245,604246,604247,604248,604249,604250,604251,604252,604253,604254,604255,604256,604257,604258,604259,604260,604261,604262,604263,604264,604265,604266,604267,604268,604269,604270,604849,800040,800068,800089,800174,800175,800182,800183,800232,800233,800608,800611,800671,800672,800868,800869,800870,800898,800899,800900,800989,800990,800991,800996,800997,801010,801149,801163,801164,801264,801617,801968,802808,802809,802810
--)

--ROLLBACK TRAN