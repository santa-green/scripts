    USE ElitR

	--задублированые позиции
	--;WITH CTE as (SELECT ROW_NUMBER()OVER(PARTITION BY DocID ORDER BY DocID) n,* FROM  [192.168.42.6].FFood601.dbo.t_MonRec  m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 )
	--;WITH CTE as (SELECT ChID, DocID,ROW_NUMBER()OVER(PARTITION BY DocID ORDER BY DocID) n FROM  dbo.t_MonRec  m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 )

	;WITH CTE as (SELECT ChID, DocID,ROW_NUMBER()OVER(PARTITION BY DocID ORDER BY DocID) n FROM  [192.168.42.6].FFood601.dbo.t_MonRec  m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 )
	SELECT * FROM CTE where N > 1 ORDER BY 1,2

	SELECT * FROM t_MonRec tmr WHERE tmr.ChID BETWEEN 1700000000 AND 1799999999	AND tmr.ChID NOT IN (SELECT m.ChID FROM [192.168.42.6].FFood601.dbo.t_MonRec m WHERE m.ChID BETWEEN 1700000000 AND 1799999999);

/*
	--Удалить дубликаты в [192.168.42.6].FFood601.dbo.t_MonRec
	;WITH CTE as (SELECT ChID, DocID,ROW_NUMBER()OVER(PARTITION BY DocID ORDER BY DocID) n FROM  [192.168.42.6].FFood601.dbo.t_MonRec  m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 )
	delete  CTE where N > 1 
	--Удалить дубликаты в t_MonRec
	DELETE t_MonRec  WHERE ChID BETWEEN 1700000000 AND 1799999999	AND ChID NOT IN (SELECT m.ChID FROM [192.168.42.6].FFood601.dbo.t_MonRec m WHERE m.ChID BETWEEN 1700000000 AND 1799999999);
*/




	SELECT ChID, OurID, AccountAC, DocDate, DocID, StockID, CompID, CompAccountAC, CurrID, KursMC, KursCC, SumAC, Subject, CodeID1, CodeID2, CodeID3, CodeID4, CodeID5, EmpID, StateCode, 0
	FROM [192.168.42.6].FFood601.dbo.t_MonRec tmr WHERE tmr.ChID BETWEEN 1700000000 AND 1799999999
	AND tmr.ChID NOT IN (SELECT m.ChID FROM t_MonRec m WHERE m.ChID BETWEEN 1700000000 AND 1799999999);


	SELECT SUM(SumAC) FROM [192.168.42.6].FFood601.dbo.t_MonRec  tmr WHERE ChID BETWEEN 1700000000 AND 1799999999
	SELECT SUM(SumAC) FROM t_MonRec tmr WHERE ChID BETWEEN 1700000000 AND 1799999999


/*
	--  SELECT * FROM t_MonRec m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 AND DocID IN (1700006431,1700006742)
	--  SELECT * FROM [192.168.42.6].FFood601.dbo.t_MonRec m WHERE m.ChID BETWEEN 1700000000 AND 1799999999 AND DocID IN (1700006431,1700006742)



GO	
DECLARE 1700000000 INT = 1700000000, 1799999999 INT = 1799999999;

SELECT * FROM t_Sale m WHERE m.ChID BETWEEN 1700000000 AND 1799999999
AND CodeID1 = 0 AND TRealSum <> 0

SELECT * FROM [192.168.42.6].FFood601.dbo.t_Sale m WHERE m.ChID BETWEEN 1700000000 AND 1799999999
AND CodeID1 = 0 AND TRealSum <> 0

SELECT * FROM t_Sale m WHERE m.ChID in (1700006323,1700000103,1700000104)
SELECT * FROM [192.168.42.6].FFood601.dbo.t_Sale m WHERE m.ChID in (1700006431,1700006742,1700007155)

*/