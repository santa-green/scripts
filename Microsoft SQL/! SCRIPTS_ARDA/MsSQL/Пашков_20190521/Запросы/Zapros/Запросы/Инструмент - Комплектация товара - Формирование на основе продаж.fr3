<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.11.2" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39630,5871330556" ReportOptions.Description.Text="" ReportOptions.LastChange="40931,603646875" ScriptLanguage="PascalScript" ScriptText.Text="Var Msg, SQL, Err: string;&#13;&#10;&#13;&#10;procedure btn_OkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;              SQL:= 'EXECUTE ip_SalesToSRec ' +&#13;&#10;              '@BDate = ' + ДатуВСтроку(ctl_Start.Date, 2) +&#13;&#10;              ', @EDate = ' + ДатуВСтроку(ctl_End.Date, 2) +&#13;&#10;              ', @OurID = ' + VarToStr(ctl_Our.KeyValue) +&#13;&#10;              ', @StockID = ' + VarToStr(ctl_Stock.KeyValue) +&#13;&#10;              ', @UseRestShift = ' + BoolToStr(ctl_UseRestShift.Checked);&#13;&#10;;&#13;&#10;              Err:= ВыполнитьSQLЗапрос(SQL, False);&#13;&#10;              if Err &#60;&#62; '' then ShowMessage(Err);&#13;&#10;              dlg_Filter.ModalResult:= mrCancel;&#13;&#10;&#13;&#10;       Msg:=   'Операция завершена.';&#13;&#10;       ShowMessage(Msg);&#13;&#10;end;&#13;&#10;&#13;&#10;Procedure btn_AskPeriodOnClick(Sender: TfrxComponent);&#13;&#10;Var&#13;&#10;  s: String;&#13;&#10;Begin&#13;&#10;  s:= ВыборПериода(ctl_Start.Date, ctl_Start.Date, 0);&#13;&#10;  If s = '' Then Exit;&#13;&#10;  ctl_Start.Date:= StrToDate(ПараметрИзСтроки(1, s, ';'));&#13;&#10;  ctl_End.Date:= StrToDate(ПараметрИзСтроки(2, s, ';'));&#13;&#10;End;&#13;&#10;&#13;&#10;begin&#13;&#10;       dq_UserVars.Open;&#13;&#10;       ctl_Our.KeyValue:= dq_UserVars.FieldByName('OurID').AsInteger;&#13;&#10;       ctl_Stock.KeyValue:= dq_UserVars.FieldByName('StockID').AsInteger;&#13;&#10;       ctl_UseRestShift.Checked:= StrToBool(dq_UserVars.FieldByName('UseShift').AsString);&#13;&#10;       ctl_Start.Date:= Date - 1;&#13;&#10;       ctl_End.Date:= Date - 1;&#13;&#10;end." StoreInDFM="False" PropData="044C656674022803546F70020F0844617461736574730101062820446174615365743D2264715F4F7572732220446174615365744E616D653D2264715F4F757273220001062C20446174615365743D2264715F53746F636B732220446174615365744E616D653D2264715F53746F636B73220001063020446174615365743D2264715F55736572566172732220446174615365744E616D653D2264715F5573657256617273220000095661726961626C657301010619204E616D653D2220474D53204F666669636520546F6F6C73220001061A204E616D653D224F6666696365546F6F6C7346696C74657231220001061A204E616D653D224F6666696365546F6F6C7346696C74657232220001061A204E616D653D224F6666696365546F6F6C7346696C74657233220001061A204E616D653D224F6666696365546F6F6C7346696C74657234220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="dq_Ours" UserName="dq_Ours" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;       OurID, OurName&#13;&#10;FROM r_Ours WITH (NOLOCK)&#13;&#10;ORDER BY&#13;&#10;       OurID" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667402240470546F70021C0A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_Stocks" UserName="dq_Stocks" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;       StockID, StockName&#13;&#10;FROM r_Stocks WITH (NOLOCK)&#13;&#10;ORDER BY&#13;&#10;       StockID  " DatabaseName="dbMain" SessionName="Default" PropData="05704C656674026C0470546F70021C0A506172616D65746572730100"/>
    <TfrxBDEQuery Name="dq_UserVars" UserName="dq_UserVars" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;  dbo.zf_UserVar('t_OurID') OurID,&#13;&#10;  dbo.zf_UserVar('t_StockID') StockID,&#13;&#10;  dbo.zf_Var('Rest_UseShifts') UseShift" DatabaseName="dbMain" SessionName="Default" PropData="05704C65667403B0000470546F70021C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="dlg_Filter" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Комплектация товара: Формирование" Height="284" ClientHeight="252" Left="343" Top="127" Width="288" ClientWidth="280">
    <TfrxButtonControl Name="btn_Ok" Left="28" Top="212" Width="75" Height="25" ShowHint="True" Caption="OK" Default="True" OnClick="btn_OkOnClick"/>
    <TfrxButtonControl Name="btn_Cancel" Left="172" Top="212" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxGroupBoxControl Name="GroupBox1" Left="12" Top="80" Width="255" Height="84" ShowHint="True" Caption="  Период  " Color="-16777201">
      <TfrxDateEditControl Name="ctl_Start" Left="12" Top="41" Width="90" Height="20" ShowHint="True" Color="-16777211" Date="38964,0394149653" Time="38964,0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label1" Left="12" Top="22" Width="90" Height="15" ShowHint="True" AutoSize="False" Caption="Начальная Дата:" Color="-16777201"/>
      <TfrxDateEditControl Name="ctl_End" Left="117" Top="41" Width="90" Height="20" ShowHint="True" Color="-16777211" Date="38964,0394149653" Time="38964,0394149653" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label2" Left="117" Top="22" Width="90" Height="15" ShowHint="True" AutoSize="False" Caption="Конечная Дата:" Color="-16777201"/>
      <TfrxButtonControl Name="btn_AskPeriod" Left="219" Top="39" Width="24" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="..." OnClick="btn_AskPeriodOnClick"/>
    </TfrxGroupBoxControl>
    <TfrxDBLookupComboBox Name="ctl_Our" Left="64" Top="12" Width="201" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="dq_Ours" DataSetName="dq_Ours" ListField="OurName" KeyField="OurID" DropDownWidth="0" DropDownRows="7"/>
    <TfrxDBLookupComboBox Name="ctl_Stock" Left="64" Top="44" Width="201" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="dq_Stocks" DataSetName="dq_Stocks" ListField="StockName" KeyField="StockID" DropDownWidth="0" DropDownRows="7"/>
    <TfrxLabelControl Name="Label3" Left="12" Top="16" Width="36" Height="13" ShowHint="True" Caption="Фирма:" Color="-16777201"/>
    <TfrxLabelControl Name="Label4" Left="12" Top="48" Width="36" Height="13" ShowHint="True" Caption="Склад:" Color="-16777201"/>
    <TfrxCheckBoxControl Name="ctl_UseRestShift" Left="12" Top="176" Width="253" Height="17" ShowHint="True" Caption="Использовать смены" Checked="True" State="cbChecked" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
